<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Use case: database credential rotation | Rundeck Docs</title>
    <meta name="description" content="">
    
    
    <link rel="preload" href="/docs-vuepress/assets/css/0.styles.0651efe2.css" as="style"><link rel="preload" href="/docs-vuepress/assets/js/app.a985d805.js" as="script"><link rel="preload" href="/docs-vuepress/assets/js/3.b5c9ac8e.js" as="script"><link rel="preload" href="/docs-vuepress/assets/js/289.216c583c.js" as="script"><link rel="prefetch" href="/docs-vuepress/assets/js/10.8c57f175.js"><link rel="prefetch" href="/docs-vuepress/assets/js/100.720c5c50.js"><link rel="prefetch" href="/docs-vuepress/assets/js/101.45a0c7fc.js"><link rel="prefetch" href="/docs-vuepress/assets/js/102.1d8bd5c8.js"><link rel="prefetch" href="/docs-vuepress/assets/js/103.818f9f29.js"><link rel="prefetch" href="/docs-vuepress/assets/js/104.9640eecc.js"><link rel="prefetch" href="/docs-vuepress/assets/js/105.1cda6b60.js"><link rel="prefetch" href="/docs-vuepress/assets/js/106.50b0f246.js"><link rel="prefetch" href="/docs-vuepress/assets/js/107.ccfa95fb.js"><link rel="prefetch" href="/docs-vuepress/assets/js/108.18b81721.js"><link rel="prefetch" href="/docs-vuepress/assets/js/109.ea094759.js"><link rel="prefetch" href="/docs-vuepress/assets/js/11.dee5ebb1.js"><link rel="prefetch" href="/docs-vuepress/assets/js/110.e700bc0b.js"><link rel="prefetch" href="/docs-vuepress/assets/js/111.8623fc95.js"><link rel="prefetch" href="/docs-vuepress/assets/js/112.acd19042.js"><link rel="prefetch" href="/docs-vuepress/assets/js/113.c68fbd50.js"><link rel="prefetch" href="/docs-vuepress/assets/js/114.d8f52e86.js"><link rel="prefetch" href="/docs-vuepress/assets/js/115.cedf0cb8.js"><link rel="prefetch" href="/docs-vuepress/assets/js/116.7a5b94ac.js"><link rel="prefetch" href="/docs-vuepress/assets/js/117.e8b5f531.js"><link rel="prefetch" href="/docs-vuepress/assets/js/118.ddb8108a.js"><link rel="prefetch" href="/docs-vuepress/assets/js/119.dd5cb472.js"><link rel="prefetch" href="/docs-vuepress/assets/js/12.23746475.js"><link rel="prefetch" href="/docs-vuepress/assets/js/120.8b1ecf29.js"><link rel="prefetch" href="/docs-vuepress/assets/js/121.8c8a805b.js"><link rel="prefetch" href="/docs-vuepress/assets/js/122.cd160a14.js"><link rel="prefetch" href="/docs-vuepress/assets/js/123.3e2e9e24.js"><link rel="prefetch" href="/docs-vuepress/assets/js/124.eb99c0cb.js"><link rel="prefetch" href="/docs-vuepress/assets/js/125.937dace5.js"><link rel="prefetch" href="/docs-vuepress/assets/js/126.134dca42.js"><link rel="prefetch" href="/docs-vuepress/assets/js/127.5c2921a7.js"><link rel="prefetch" href="/docs-vuepress/assets/js/128.6ee7fd75.js"><link rel="prefetch" href="/docs-vuepress/assets/js/129.edc62da5.js"><link rel="prefetch" href="/docs-vuepress/assets/js/13.e0352662.js"><link rel="prefetch" href="/docs-vuepress/assets/js/130.3ff9d275.js"><link rel="prefetch" href="/docs-vuepress/assets/js/131.dcbfde6a.js"><link rel="prefetch" href="/docs-vuepress/assets/js/132.7602d8a0.js"><link rel="prefetch" href="/docs-vuepress/assets/js/133.a1309e55.js"><link rel="prefetch" href="/docs-vuepress/assets/js/134.87aa2c3b.js"><link rel="prefetch" href="/docs-vuepress/assets/js/135.6c6e6c59.js"><link rel="prefetch" href="/docs-vuepress/assets/js/136.0b4d54ed.js"><link rel="prefetch" href="/docs-vuepress/assets/js/137.98c0ae7c.js"><link rel="prefetch" href="/docs-vuepress/assets/js/138.dfe0b071.js"><link rel="prefetch" href="/docs-vuepress/assets/js/139.3314f132.js"><link rel="prefetch" href="/docs-vuepress/assets/js/14.9b6beeca.js"><link rel="prefetch" href="/docs-vuepress/assets/js/140.fa006a41.js"><link rel="prefetch" href="/docs-vuepress/assets/js/141.a3e235d0.js"><link rel="prefetch" href="/docs-vuepress/assets/js/142.a1a2724d.js"><link rel="prefetch" href="/docs-vuepress/assets/js/143.7a12b020.js"><link rel="prefetch" href="/docs-vuepress/assets/js/144.f44c26ef.js"><link rel="prefetch" href="/docs-vuepress/assets/js/145.1e057378.js"><link rel="prefetch" href="/docs-vuepress/assets/js/146.7370faa0.js"><link rel="prefetch" href="/docs-vuepress/assets/js/147.89f92872.js"><link rel="prefetch" href="/docs-vuepress/assets/js/148.5e0b8ba4.js"><link rel="prefetch" href="/docs-vuepress/assets/js/149.2c326c00.js"><link rel="prefetch" href="/docs-vuepress/assets/js/15.046d411b.js"><link rel="prefetch" href="/docs-vuepress/assets/js/150.7e2f3941.js"><link rel="prefetch" href="/docs-vuepress/assets/js/151.c2ce369b.js"><link rel="prefetch" href="/docs-vuepress/assets/js/152.7f9262c5.js"><link rel="prefetch" href="/docs-vuepress/assets/js/153.ace3a365.js"><link rel="prefetch" href="/docs-vuepress/assets/js/154.09c8412b.js"><link rel="prefetch" href="/docs-vuepress/assets/js/155.50024301.js"><link rel="prefetch" href="/docs-vuepress/assets/js/156.289fe7a7.js"><link rel="prefetch" href="/docs-vuepress/assets/js/157.28730443.js"><link rel="prefetch" href="/docs-vuepress/assets/js/158.d701bfef.js"><link rel="prefetch" href="/docs-vuepress/assets/js/159.0a91371d.js"><link rel="prefetch" href="/docs-vuepress/assets/js/16.9a3aef5f.js"><link rel="prefetch" href="/docs-vuepress/assets/js/160.eb66a553.js"><link rel="prefetch" href="/docs-vuepress/assets/js/161.26e91ef4.js"><link rel="prefetch" href="/docs-vuepress/assets/js/162.0e47c413.js"><link rel="prefetch" href="/docs-vuepress/assets/js/163.f0f29d19.js"><link rel="prefetch" href="/docs-vuepress/assets/js/164.38cc49ae.js"><link rel="prefetch" href="/docs-vuepress/assets/js/165.b3e4ebed.js"><link rel="prefetch" href="/docs-vuepress/assets/js/166.b4d8ce31.js"><link rel="prefetch" href="/docs-vuepress/assets/js/167.47213cd6.js"><link rel="prefetch" href="/docs-vuepress/assets/js/168.abec22dd.js"><link rel="prefetch" href="/docs-vuepress/assets/js/169.3dbe9d6f.js"><link rel="prefetch" href="/docs-vuepress/assets/js/17.664a95aa.js"><link rel="prefetch" href="/docs-vuepress/assets/js/170.5dff1bf7.js"><link rel="prefetch" href="/docs-vuepress/assets/js/171.8acbe31b.js"><link rel="prefetch" href="/docs-vuepress/assets/js/172.8757d159.js"><link rel="prefetch" href="/docs-vuepress/assets/js/173.441281d9.js"><link rel="prefetch" href="/docs-vuepress/assets/js/174.dcb7ee10.js"><link rel="prefetch" href="/docs-vuepress/assets/js/175.63bff5c9.js"><link rel="prefetch" href="/docs-vuepress/assets/js/176.5077aa21.js"><link rel="prefetch" href="/docs-vuepress/assets/js/177.574a081b.js"><link rel="prefetch" href="/docs-vuepress/assets/js/178.4054cadd.js"><link rel="prefetch" href="/docs-vuepress/assets/js/179.0225b9cc.js"><link rel="prefetch" href="/docs-vuepress/assets/js/18.fb35adbd.js"><link rel="prefetch" href="/docs-vuepress/assets/js/180.93a0273d.js"><link rel="prefetch" href="/docs-vuepress/assets/js/181.94609536.js"><link rel="prefetch" href="/docs-vuepress/assets/js/182.59660e9d.js"><link rel="prefetch" href="/docs-vuepress/assets/js/183.0e56e595.js"><link rel="prefetch" href="/docs-vuepress/assets/js/184.1eb6f554.js"><link rel="prefetch" href="/docs-vuepress/assets/js/185.4948eb35.js"><link rel="prefetch" href="/docs-vuepress/assets/js/186.9690e0d3.js"><link rel="prefetch" href="/docs-vuepress/assets/js/187.885e9b47.js"><link rel="prefetch" href="/docs-vuepress/assets/js/188.7fd180e6.js"><link rel="prefetch" href="/docs-vuepress/assets/js/189.66fa3148.js"><link rel="prefetch" href="/docs-vuepress/assets/js/19.2ffd98f8.js"><link rel="prefetch" href="/docs-vuepress/assets/js/190.c617ccb9.js"><link rel="prefetch" href="/docs-vuepress/assets/js/191.350027e9.js"><link rel="prefetch" href="/docs-vuepress/assets/js/192.b69db32f.js"><link rel="prefetch" href="/docs-vuepress/assets/js/193.c854b7da.js"><link rel="prefetch" href="/docs-vuepress/assets/js/194.8f5d7f30.js"><link rel="prefetch" href="/docs-vuepress/assets/js/195.59bd471c.js"><link rel="prefetch" href="/docs-vuepress/assets/js/196.5c3d5676.js"><link rel="prefetch" href="/docs-vuepress/assets/js/197.e02f5ef3.js"><link rel="prefetch" href="/docs-vuepress/assets/js/198.c5f3424d.js"><link rel="prefetch" href="/docs-vuepress/assets/js/199.c60f7f0d.js"><link rel="prefetch" href="/docs-vuepress/assets/js/20.5bf2414f.js"><link rel="prefetch" href="/docs-vuepress/assets/js/200.d3efab31.js"><link rel="prefetch" href="/docs-vuepress/assets/js/201.d6097a70.js"><link rel="prefetch" href="/docs-vuepress/assets/js/202.0de99e28.js"><link rel="prefetch" href="/docs-vuepress/assets/js/203.6ca8d9d9.js"><link rel="prefetch" href="/docs-vuepress/assets/js/204.fd4f9353.js"><link rel="prefetch" href="/docs-vuepress/assets/js/205.2b8d8a23.js"><link rel="prefetch" href="/docs-vuepress/assets/js/206.fea77d34.js"><link rel="prefetch" href="/docs-vuepress/assets/js/207.ee0b9189.js"><link rel="prefetch" href="/docs-vuepress/assets/js/208.ba6c5a96.js"><link rel="prefetch" href="/docs-vuepress/assets/js/209.91eae380.js"><link rel="prefetch" href="/docs-vuepress/assets/js/21.b203d7cf.js"><link rel="prefetch" href="/docs-vuepress/assets/js/210.2da81b3c.js"><link rel="prefetch" href="/docs-vuepress/assets/js/211.9e827795.js"><link rel="prefetch" href="/docs-vuepress/assets/js/212.d76bc91c.js"><link rel="prefetch" href="/docs-vuepress/assets/js/213.92c7af9d.js"><link rel="prefetch" href="/docs-vuepress/assets/js/214.85f4977b.js"><link rel="prefetch" href="/docs-vuepress/assets/js/215.f56b3e80.js"><link rel="prefetch" href="/docs-vuepress/assets/js/216.81b0ccdf.js"><link rel="prefetch" href="/docs-vuepress/assets/js/217.1cfddf1c.js"><link rel="prefetch" href="/docs-vuepress/assets/js/218.894eaaa3.js"><link rel="prefetch" href="/docs-vuepress/assets/js/219.a3db190a.js"><link rel="prefetch" href="/docs-vuepress/assets/js/22.c3ed0db3.js"><link rel="prefetch" href="/docs-vuepress/assets/js/220.74cb3a9b.js"><link rel="prefetch" href="/docs-vuepress/assets/js/221.ebd3cfb6.js"><link rel="prefetch" href="/docs-vuepress/assets/js/222.cf2e564e.js"><link rel="prefetch" href="/docs-vuepress/assets/js/223.6f31881a.js"><link rel="prefetch" href="/docs-vuepress/assets/js/224.2f3ccc09.js"><link rel="prefetch" href="/docs-vuepress/assets/js/225.7be205b5.js"><link rel="prefetch" href="/docs-vuepress/assets/js/226.caa2df29.js"><link rel="prefetch" href="/docs-vuepress/assets/js/227.0372aa61.js"><link rel="prefetch" href="/docs-vuepress/assets/js/228.93553be0.js"><link rel="prefetch" href="/docs-vuepress/assets/js/229.e0f6ab8b.js"><link rel="prefetch" href="/docs-vuepress/assets/js/23.41eee484.js"><link rel="prefetch" href="/docs-vuepress/assets/js/230.20ed8418.js"><link rel="prefetch" href="/docs-vuepress/assets/js/231.95fe785d.js"><link rel="prefetch" href="/docs-vuepress/assets/js/232.ea65cd4a.js"><link rel="prefetch" href="/docs-vuepress/assets/js/233.80e6a6b3.js"><link rel="prefetch" href="/docs-vuepress/assets/js/234.f3e529d3.js"><link rel="prefetch" href="/docs-vuepress/assets/js/235.7eecef3f.js"><link rel="prefetch" href="/docs-vuepress/assets/js/236.9c545505.js"><link rel="prefetch" href="/docs-vuepress/assets/js/237.a8a8b39b.js"><link rel="prefetch" href="/docs-vuepress/assets/js/238.7853d502.js"><link rel="prefetch" href="/docs-vuepress/assets/js/239.b7b28627.js"><link rel="prefetch" href="/docs-vuepress/assets/js/24.2fac9289.js"><link rel="prefetch" href="/docs-vuepress/assets/js/240.10d59b00.js"><link rel="prefetch" href="/docs-vuepress/assets/js/241.eb19c22c.js"><link rel="prefetch" href="/docs-vuepress/assets/js/242.7ac7c03b.js"><link rel="prefetch" href="/docs-vuepress/assets/js/243.f0bd838e.js"><link rel="prefetch" href="/docs-vuepress/assets/js/244.d5fdf8da.js"><link rel="prefetch" href="/docs-vuepress/assets/js/245.6c9d83f7.js"><link rel="prefetch" href="/docs-vuepress/assets/js/246.52f008f9.js"><link rel="prefetch" href="/docs-vuepress/assets/js/247.657640e7.js"><link rel="prefetch" href="/docs-vuepress/assets/js/248.e2e63637.js"><link rel="prefetch" href="/docs-vuepress/assets/js/249.7992cefd.js"><link rel="prefetch" href="/docs-vuepress/assets/js/25.b539bab6.js"><link rel="prefetch" href="/docs-vuepress/assets/js/250.dcc7c35b.js"><link rel="prefetch" href="/docs-vuepress/assets/js/251.0c779c2f.js"><link rel="prefetch" href="/docs-vuepress/assets/js/252.52074ddf.js"><link rel="prefetch" href="/docs-vuepress/assets/js/253.16219d68.js"><link rel="prefetch" href="/docs-vuepress/assets/js/254.3612c2fe.js"><link rel="prefetch" href="/docs-vuepress/assets/js/255.54a4ce7e.js"><link rel="prefetch" href="/docs-vuepress/assets/js/256.87f760f6.js"><link rel="prefetch" href="/docs-vuepress/assets/js/257.85b5dd49.js"><link rel="prefetch" href="/docs-vuepress/assets/js/258.8b7a4dfe.js"><link rel="prefetch" href="/docs-vuepress/assets/js/259.b03392a2.js"><link rel="prefetch" href="/docs-vuepress/assets/js/26.45439bc6.js"><link rel="prefetch" href="/docs-vuepress/assets/js/260.a880f7e5.js"><link rel="prefetch" href="/docs-vuepress/assets/js/261.b26ce62a.js"><link rel="prefetch" href="/docs-vuepress/assets/js/262.b558c7d3.js"><link rel="prefetch" href="/docs-vuepress/assets/js/263.81e1b2aa.js"><link rel="prefetch" href="/docs-vuepress/assets/js/264.24e8b643.js"><link rel="prefetch" href="/docs-vuepress/assets/js/265.416fe785.js"><link rel="prefetch" href="/docs-vuepress/assets/js/266.9cd4fc1e.js"><link rel="prefetch" href="/docs-vuepress/assets/js/267.25cda5da.js"><link rel="prefetch" href="/docs-vuepress/assets/js/268.e930295e.js"><link rel="prefetch" href="/docs-vuepress/assets/js/269.45ce7d9c.js"><link rel="prefetch" href="/docs-vuepress/assets/js/27.ddaf853a.js"><link rel="prefetch" href="/docs-vuepress/assets/js/270.8fcd51aa.js"><link rel="prefetch" href="/docs-vuepress/assets/js/271.232f376e.js"><link rel="prefetch" href="/docs-vuepress/assets/js/272.79771cdd.js"><link rel="prefetch" href="/docs-vuepress/assets/js/273.b4de4ba5.js"><link rel="prefetch" href="/docs-vuepress/assets/js/274.35696c8f.js"><link rel="prefetch" href="/docs-vuepress/assets/js/275.bc5a82c1.js"><link rel="prefetch" href="/docs-vuepress/assets/js/276.6122526d.js"><link rel="prefetch" href="/docs-vuepress/assets/js/277.10591be2.js"><link rel="prefetch" href="/docs-vuepress/assets/js/278.ed12e43c.js"><link rel="prefetch" href="/docs-vuepress/assets/js/279.39f0ecc2.js"><link rel="prefetch" href="/docs-vuepress/assets/js/28.3726bb37.js"><link rel="prefetch" href="/docs-vuepress/assets/js/280.f400863b.js"><link rel="prefetch" href="/docs-vuepress/assets/js/281.089d4757.js"><link rel="prefetch" href="/docs-vuepress/assets/js/282.0bc28dcc.js"><link rel="prefetch" href="/docs-vuepress/assets/js/283.566f57a8.js"><link rel="prefetch" href="/docs-vuepress/assets/js/284.53214203.js"><link rel="prefetch" href="/docs-vuepress/assets/js/285.c9b58e9d.js"><link rel="prefetch" href="/docs-vuepress/assets/js/286.2ed1160a.js"><link rel="prefetch" href="/docs-vuepress/assets/js/287.432dca89.js"><link rel="prefetch" href="/docs-vuepress/assets/js/288.bd26ad7a.js"><link rel="prefetch" href="/docs-vuepress/assets/js/29.9f751b56.js"><link rel="prefetch" href="/docs-vuepress/assets/js/290.15e58491.js"><link rel="prefetch" href="/docs-vuepress/assets/js/291.5bdbe5ca.js"><link rel="prefetch" href="/docs-vuepress/assets/js/292.f679a7a9.js"><link rel="prefetch" href="/docs-vuepress/assets/js/293.6d76eb9c.js"><link rel="prefetch" href="/docs-vuepress/assets/js/30.516fa878.js"><link rel="prefetch" href="/docs-vuepress/assets/js/31.d119aa3b.js"><link rel="prefetch" href="/docs-vuepress/assets/js/32.6151ee25.js"><link rel="prefetch" href="/docs-vuepress/assets/js/33.9f80c25c.js"><link rel="prefetch" href="/docs-vuepress/assets/js/34.60a49bea.js"><link rel="prefetch" href="/docs-vuepress/assets/js/35.63cea81a.js"><link rel="prefetch" href="/docs-vuepress/assets/js/36.4ed3bc37.js"><link rel="prefetch" href="/docs-vuepress/assets/js/37.0722c4d3.js"><link rel="prefetch" href="/docs-vuepress/assets/js/38.fb1d7e70.js"><link rel="prefetch" href="/docs-vuepress/assets/js/39.37676094.js"><link rel="prefetch" href="/docs-vuepress/assets/js/4.8d9000c0.js"><link rel="prefetch" href="/docs-vuepress/assets/js/40.71cbda52.js"><link rel="prefetch" href="/docs-vuepress/assets/js/41.71e07508.js"><link rel="prefetch" href="/docs-vuepress/assets/js/42.7a076a48.js"><link rel="prefetch" href="/docs-vuepress/assets/js/43.de045d01.js"><link rel="prefetch" href="/docs-vuepress/assets/js/44.d4683cdd.js"><link rel="prefetch" href="/docs-vuepress/assets/js/45.594fbcb8.js"><link rel="prefetch" href="/docs-vuepress/assets/js/46.b515f50f.js"><link rel="prefetch" href="/docs-vuepress/assets/js/47.c6d8e7d2.js"><link rel="prefetch" href="/docs-vuepress/assets/js/48.708580d5.js"><link rel="prefetch" href="/docs-vuepress/assets/js/49.5db8f508.js"><link rel="prefetch" href="/docs-vuepress/assets/js/5.80e31771.js"><link rel="prefetch" href="/docs-vuepress/assets/js/50.da39405f.js"><link rel="prefetch" href="/docs-vuepress/assets/js/51.97cca045.js"><link rel="prefetch" href="/docs-vuepress/assets/js/52.dd6d2f2f.js"><link rel="prefetch" href="/docs-vuepress/assets/js/53.26fa76af.js"><link rel="prefetch" href="/docs-vuepress/assets/js/54.ba647451.js"><link rel="prefetch" href="/docs-vuepress/assets/js/55.b04e9047.js"><link rel="prefetch" href="/docs-vuepress/assets/js/56.6331165b.js"><link rel="prefetch" href="/docs-vuepress/assets/js/57.7d741e8d.js"><link rel="prefetch" href="/docs-vuepress/assets/js/58.c8bfc387.js"><link rel="prefetch" href="/docs-vuepress/assets/js/59.b81608de.js"><link rel="prefetch" href="/docs-vuepress/assets/js/6.1cf912d2.js"><link rel="prefetch" href="/docs-vuepress/assets/js/60.0f3417a7.js"><link rel="prefetch" href="/docs-vuepress/assets/js/61.daa6a6a4.js"><link rel="prefetch" href="/docs-vuepress/assets/js/62.07318418.js"><link rel="prefetch" href="/docs-vuepress/assets/js/63.d3c27254.js"><link rel="prefetch" href="/docs-vuepress/assets/js/64.39464958.js"><link rel="prefetch" href="/docs-vuepress/assets/js/65.ccb705ad.js"><link rel="prefetch" href="/docs-vuepress/assets/js/66.15e21b72.js"><link rel="prefetch" href="/docs-vuepress/assets/js/67.ab78df7e.js"><link rel="prefetch" href="/docs-vuepress/assets/js/68.185ed3ae.js"><link rel="prefetch" href="/docs-vuepress/assets/js/69.f1316862.js"><link rel="prefetch" href="/docs-vuepress/assets/js/7.5878d871.js"><link rel="prefetch" href="/docs-vuepress/assets/js/70.dbaab2a0.js"><link rel="prefetch" href="/docs-vuepress/assets/js/71.065e10d4.js"><link rel="prefetch" href="/docs-vuepress/assets/js/72.54a98305.js"><link rel="prefetch" href="/docs-vuepress/assets/js/73.8765df33.js"><link rel="prefetch" href="/docs-vuepress/assets/js/74.c89c0de9.js"><link rel="prefetch" href="/docs-vuepress/assets/js/75.b4fee156.js"><link rel="prefetch" href="/docs-vuepress/assets/js/76.0fd462f8.js"><link rel="prefetch" href="/docs-vuepress/assets/js/77.81a3cbfc.js"><link rel="prefetch" href="/docs-vuepress/assets/js/78.3354c788.js"><link rel="prefetch" href="/docs-vuepress/assets/js/79.e2adf14b.js"><link rel="prefetch" href="/docs-vuepress/assets/js/8.ece585dd.js"><link rel="prefetch" href="/docs-vuepress/assets/js/80.fe383144.js"><link rel="prefetch" href="/docs-vuepress/assets/js/81.acd227a5.js"><link rel="prefetch" href="/docs-vuepress/assets/js/82.99ea1922.js"><link rel="prefetch" href="/docs-vuepress/assets/js/83.38f4ff44.js"><link rel="prefetch" href="/docs-vuepress/assets/js/84.85e207e7.js"><link rel="prefetch" href="/docs-vuepress/assets/js/85.24d3a974.js"><link rel="prefetch" href="/docs-vuepress/assets/js/86.ffeec6c2.js"><link rel="prefetch" href="/docs-vuepress/assets/js/87.d136299c.js"><link rel="prefetch" href="/docs-vuepress/assets/js/88.e18b3105.js"><link rel="prefetch" href="/docs-vuepress/assets/js/89.a54f7a26.js"><link rel="prefetch" href="/docs-vuepress/assets/js/9.47c58519.js"><link rel="prefetch" href="/docs-vuepress/assets/js/90.8ed21a9f.js"><link rel="prefetch" href="/docs-vuepress/assets/js/91.52bcd084.js"><link rel="prefetch" href="/docs-vuepress/assets/js/92.0938aa71.js"><link rel="prefetch" href="/docs-vuepress/assets/js/93.450d6d7e.js"><link rel="prefetch" href="/docs-vuepress/assets/js/94.e12d4854.js"><link rel="prefetch" href="/docs-vuepress/assets/js/95.f2e582c0.js"><link rel="prefetch" href="/docs-vuepress/assets/js/96.49c7d3d9.js"><link rel="prefetch" href="/docs-vuepress/assets/js/97.80334f46.js"><link rel="prefetch" href="/docs-vuepress/assets/js/98.4aba028d.js"><link rel="prefetch" href="/docs-vuepress/assets/js/99.afa3e890.js"><link rel="prefetch" href="/docs-vuepress/assets/js/vendors~docsearch.41e08fbe.js">
    <link rel="stylesheet" href="/docs-vuepress/assets/css/0.styles.0651efe2.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/docs-vuepress/" class="home-link router-link-active"><img src="/docs-vuepress/images/rundecklogo-black.png" alt="Rundeck Docs" class="logo"> <span class="site-name can-hide">Rundeck Docs</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">User Guide</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs-vuepress/manual/01-introduction.html" class="nav-link">Introduction</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/manual/02-getting-help.html" class="nav-link">Getting Help</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/manual/03-getting-started.html" class="nav-link">Getting Started</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/manual/04-jobs.html" class="nav-link">Jobs</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/manual/05-nodes.html" class="nav-link">Nodes</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/manual/06-commands.html" class="nav-link">Commands</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/manual/07-executions.html" class="nav-link">Executions</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/manual/08-activity.html" class="nav-link">Activity</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/manual/09-configure.html" class="nav-link">Configure</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/manual/10-user.html" class="nav-link">User</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/manual/11-node-filters.html" class="nav-link">Node Filters</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/manual/12-webhooks.html" class="nav-link">Webhooks</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Tutorials</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs-vuepress/tutorials/index.html" class="nav-link">Overview</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/tutorials/project-setup.html" class="nav-link">Project Setup</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/tutorials/nodes.html" class="nav-link">Nodes</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/tutorials/jobs.html" class="nav-link">Jobs</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/tutorials/command-dispatch.html" class="nav-link">Commands</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/tutorials/access-control.html" class="nav-link">Access Control</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/tutorials/option-provider.html" class="nav-link">Option Provider</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/tutorials/custom-script-plugin-hello-world.html" class="nav-link">Custom Script Plugin - Hello World</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/tutorials/custom-script-plugin-db-cred-rotation.html" class="nav-link router-link-exact-active router-link-active">Custom Script Plugin - DB Credential Rotation</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/tutorials/log-filters.html" class="nav-link">Log Filters</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/tutorials/java-plugin.html" class="nav-link">Java Plugin</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Administration</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs-vuepress/administration/" class="nav-link">Overview</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/administration/install/" class="nav-link">Installation</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/administration/configuration/" class="nav-link">Configuration</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/plugins/" class="nav-link">Plugins</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/administration/security/default-users.html" class="nav-link">Security</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/administration/maintenance/index.html" class="nav-link">Maintenance</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/administration/upgrading/index.html" class="nav-link">Upgrading</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/administration/cluster/index.html" class="nav-link">Cluster</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/administration/projects/index.html" class="nav-link">Projects</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Enterprise</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs-vuepress/enterprise/" class="nav-link">Overview</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/enterprise/quickstart.html" class="nav-link">Quickstart</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Development</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs-vuepress/api/rundeck-api.html" class="nav-link">API</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/developer/index.html" class="nav-link">Plugin Development</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/manual/command-line-tools/" class="nav-link">Command Line Tools</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/history/" class="nav-link">History</a></li></ul></div></div> <a href="https://github.com/rundeck/docs-vuepress" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">User Guide</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs-vuepress/manual/01-introduction.html" class="nav-link">Introduction</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/manual/02-getting-help.html" class="nav-link">Getting Help</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/manual/03-getting-started.html" class="nav-link">Getting Started</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/manual/04-jobs.html" class="nav-link">Jobs</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/manual/05-nodes.html" class="nav-link">Nodes</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/manual/06-commands.html" class="nav-link">Commands</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/manual/07-executions.html" class="nav-link">Executions</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/manual/08-activity.html" class="nav-link">Activity</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/manual/09-configure.html" class="nav-link">Configure</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/manual/10-user.html" class="nav-link">User</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/manual/11-node-filters.html" class="nav-link">Node Filters</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/manual/12-webhooks.html" class="nav-link">Webhooks</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Tutorials</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs-vuepress/tutorials/index.html" class="nav-link">Overview</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/tutorials/project-setup.html" class="nav-link">Project Setup</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/tutorials/nodes.html" class="nav-link">Nodes</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/tutorials/jobs.html" class="nav-link">Jobs</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/tutorials/command-dispatch.html" class="nav-link">Commands</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/tutorials/access-control.html" class="nav-link">Access Control</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/tutorials/option-provider.html" class="nav-link">Option Provider</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/tutorials/custom-script-plugin-hello-world.html" class="nav-link">Custom Script Plugin - Hello World</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/tutorials/custom-script-plugin-db-cred-rotation.html" class="nav-link router-link-exact-active router-link-active">Custom Script Plugin - DB Credential Rotation</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/tutorials/log-filters.html" class="nav-link">Log Filters</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/tutorials/java-plugin.html" class="nav-link">Java Plugin</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Administration</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs-vuepress/administration/" class="nav-link">Overview</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/administration/install/" class="nav-link">Installation</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/administration/configuration/" class="nav-link">Configuration</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/plugins/" class="nav-link">Plugins</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/administration/security/default-users.html" class="nav-link">Security</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/administration/maintenance/index.html" class="nav-link">Maintenance</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/administration/upgrading/index.html" class="nav-link">Upgrading</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/administration/cluster/index.html" class="nav-link">Cluster</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/administration/projects/index.html" class="nav-link">Projects</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Enterprise</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs-vuepress/enterprise/" class="nav-link">Overview</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/enterprise/quickstart.html" class="nav-link">Quickstart</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Development</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs-vuepress/api/rundeck-api.html" class="nav-link">API</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/developer/index.html" class="nav-link">Plugin Development</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/manual/command-line-tools/" class="nav-link">Command Line Tools</a></li><li class="dropdown-item"><!----> <a href="/docs-vuepress/history/" class="nav-link">History</a></li></ul></div></div> <a href="https://github.com/rundeck/docs-vuepress" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/docs-vuepress/tutorials/project-setup.html" class="sidebar-link">Planning for the project</a></li><li><a href="/docs-vuepress/tutorials/nodes.html" class="sidebar-link">Listing and filtering nodes</a></li><li><a href="/docs-vuepress/tutorials/jobs.html" class="sidebar-link">Jobs</a></li><li><a href="/docs-vuepress/tutorials/command-dispatch.html" class="sidebar-link">Commands</a></li><li><a href="/docs-vuepress/tutorials/access-control.html" class="sidebar-link">Access control</a></li><li><a href="/docs-vuepress/tutorials/option-provider.html" class="sidebar-link">Remote option provider</a></li><li><a href="/docs-vuepress/tutorials/custom-script-plugin-hello-world.html" class="sidebar-link">Developing a custom Rundeck script plugin</a></li><li><a href="/docs-vuepress/tutorials/custom-script-plugin-db-cred-rotation.html" class="active sidebar-link">Use case: database credential rotation</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs-vuepress/tutorials/custom-script-plugin-db-cred-rotation.html#the-problem" class="sidebar-link">The problem</a></li><li class="sidebar-sub-header"><a href="/docs-vuepress/tutorials/custom-script-plugin-db-cred-rotation.html#addressing-the-problem-with-rundeck" class="sidebar-link">Addressing the problem with Rundeck</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs-vuepress/tutorials/custom-script-plugin-db-cred-rotation.html#secure-secrets-handling" class="sidebar-link">Secure secrets handling</a></li><li class="sidebar-sub-header"><a href="/docs-vuepress/tutorials/custom-script-plugin-db-cred-rotation.html#critical-logic-is-tested-ahead-of-time" class="sidebar-link">Critical logic is tested ahead of time</a></li><li class="sidebar-sub-header"><a href="/docs-vuepress/tutorials/custom-script-plugin-db-cred-rotation.html#ease-of-use-encourages-proactive-security" class="sidebar-link">Ease of use encourages proactive security</a></li></ul></li><li class="sidebar-sub-header"><a href="/docs-vuepress/tutorials/custom-script-plugin-db-cred-rotation.html#automating-credential-rotation-with-rundeck" class="sidebar-link">Automating credential rotation with Rundeck</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs-vuepress/tutorials/custom-script-plugin-db-cred-rotation.html#restarting-the-apps" class="sidebar-link">Restarting the apps</a></li><li class="sidebar-sub-header"><a href="/docs-vuepress/tutorials/custom-script-plugin-db-cred-rotation.html#modifying-the-app-config" class="sidebar-link">Modifying the app config</a></li><li class="sidebar-sub-header"><a href="/docs-vuepress/tutorials/custom-script-plugin-db-cred-rotation.html#creating-the-new-db-login" class="sidebar-link">Creating the new db login</a></li><li class="sidebar-sub-header"><a href="/docs-vuepress/tutorials/custom-script-plugin-db-cred-rotation.html#deleting-the-old-db-login" class="sidebar-link">Deleting the old db login</a></li><li class="sidebar-sub-header"><a href="/docs-vuepress/tutorials/custom-script-plugin-db-cred-rotation.html#tying-it-all-together" class="sidebar-link">Tying it all together</a></li></ul></li></ul></li><li><a href="/docs-vuepress/tutorials/log-filters.html" class="sidebar-link">Using Log Filters</a></li><li><a href="/docs-vuepress/tutorials/java-plugin.html" class="sidebar-link">Developing a custom Rundeck Java plugin</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="use-case-database-credential-rotation"><a href="#use-case-database-credential-rotation" aria-hidden="true" class="header-anchor">#</a> Use case: database credential rotation</h1> <p>Now that we know how to create custom workflow step script plugin in the <a href="/docs-vuepress/tutorials/custom-script-plugin-hello-world.html">hello world tutorial</a>, let's walk through a real world use case: rotation database credentials. Credential rotation has traditionally been a complicated, thankless administrative chore. It's the type of work that might be labeled <a href="https://landing.google.com/sre/book/chapters/eliminating-toil.html" target="_blank" rel="noopener noreferrer">toil<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> and exactly the kind of work that Rundeck has been designed to streamline.</p> <p>The end result of this tutorial as well as a Docker environment to run it in can be found on <a href="https://github.com/clofresh/rundeck-playground" target="_blank" rel="noopener noreferrer">GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="the-problem"><a href="#the-problem" aria-hidden="true" class="header-anchor">#</a> The problem</h2> <p>What's difficult about database credential rotation?</p> <ul><li>It involves multiple steps across multiple nodes in your production cluster.</li> <li>It's necessary to handle secrets in the form of the new credentials you're creating, plus credentials of a super user that can create the new login.</li> <li>Manually run steps are error prone and mistakes can potentially cause a site-wide outage if your app can't authenticate with the database anymore.</li></ul> <h2 id="addressing-the-problem-with-rundeck"><a href="#addressing-the-problem-with-rundeck" aria-hidden="true" class="header-anchor">#</a> Addressing the problem with Rundeck</h2> <p>By creating a custom script plugin to interact with the database, its downstream clients and the Rundeck Key Storage, we can automate the creation and deployment of the new credentials as well as safely handle the decomissioning of the old credentials.</p> <h3 id="secure-secrets-handling"><a href="#secure-secrets-handling" aria-hidden="true" class="header-anchor">#</a> Secure secrets handling</h3> <p>Since the Key Storage stores the credentials, the administrator triggering the credential rotation doesn't ever need to see the actual credentials of the database super user or the newly generated database user.</p> <h3 id="critical-logic-is-tested-ahead-of-time"><a href="#critical-logic-is-tested-ahead-of-time" aria-hidden="true" class="header-anchor">#</a> Critical logic is tested ahead of time</h3> <p>The logic for creating the database login is encapsulated in a script that has been tested prior to actually needing to rotate the credentials, so we avoid putting a human in the stressful, error-prone situation of having to figure out correct syntax to run on a live system on the fly.</p> <p>Similarly, the app restart logic is encapsulated as well, with health check logic as an extra safety measure to halt the process in case something has gone wrong before applying the change to the whole cluster.</p> <h3 id="ease-of-use-encourages-proactive-security"><a href="#ease-of-use-encourages-proactive-security" aria-hidden="true" class="header-anchor">#</a> Ease of use encourages proactive security</h3> <p>Lastly, by creating a single button solution to rotate database credentials, we're much more likely to rotate our credentials on a regular basis to mitigate potential security risks, rather than only after a security incident has already occured.</p> <h2 id="automating-credential-rotation-with-rundeck"><a href="#automating-credential-rotation-with-rundeck" aria-hidden="true" class="header-anchor">#</a> Automating credential rotation with Rundeck</h2> <p>In order to automate the credential rotation, we need to automate the individual steps, then orchestrate the steps in a single process. The steps we want to automate are:</p> <ul><li>Creating a new database login</li> <li>Updating the application configuration to use the new database login</li> <li>Restarting the applications to apply the configuration change</li> <li>Deleting the old database login</li></ul> <h3 id="restarting-the-apps"><a href="#restarting-the-apps" aria-hidden="true" class="header-anchor">#</a> Restarting the apps</h3> <p>We can start with restarting the applications because that's something we can test on its own before proceeding. We'll create a new plugin metadata file <code>rundeck-plugins/db-creds/plugin.yaml</code>:</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">name</span><span class="token punctuation">:</span> Database credential management
<span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token number">1</span>
<span class="token key atrule">rundeckPluginVersion</span><span class="token punctuation">:</span> <span class="token number">1.2</span>
<span class="token key atrule">author</span><span class="token punctuation">:</span> Carlo Cabanilla
<span class="token key atrule">date</span><span class="token punctuation">:</span> <span class="token datetime number">2018-07-20</span>
<span class="token key atrule">url</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//rundeck.org/
<span class="token key atrule">providers</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> RestartApp
    <span class="token key atrule">service</span><span class="token punctuation">:</span> RemoteScriptNodeStep
    <span class="token key atrule">plugin-type</span><span class="token punctuation">:</span> script
    <span class="token key atrule">script-interpreter</span><span class="token punctuation">:</span> /bin/bash
    <span class="token key atrule">script-file</span><span class="token punctuation">:</span> restart.sh
    <span class="token key atrule">script-args</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span>config.process<span class="token punctuation">}</span> $<span class="token punctuation">{</span>config.health_url<span class="token punctuation">}</span>
    <span class="token key atrule">config</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">type</span><span class="token punctuation">:</span> String
        <span class="token key atrule">name</span><span class="token punctuation">:</span> process
        <span class="token key atrule">title</span><span class="token punctuation">:</span> process
        <span class="token key atrule">description</span><span class="token punctuation">:</span> the process to restart
      <span class="token punctuation">-</span> <span class="token key atrule">type</span><span class="token punctuation">:</span> String
        <span class="token key atrule">name</span><span class="token punctuation">:</span> health_url
        <span class="token key atrule">title</span><span class="token punctuation">:</span> health_url
        <span class="token key atrule">description</span><span class="token punctuation">:</span> the http endpoint to poll to check that it's healthy
        <span class="token key atrule">default</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span><span class="token number">8080</span>
</code></pre></div><p>Our restart script takes 2 parameters: the name of the process on the node, and a url that we can poll to check that it's healthy. The implementation of the restart script is specific to the Docker playground environment so we'll leave out the details, but from a high level it:</p> <ul><li>Kills the process and lets the supervising parent process restart it</li> <li>Polls the health check url until it returns healthy or times out</li> <li>Exits with an error code if it times out to let the calling process know whether to continue or not with downstream steps</li></ul> <p>In order to be able to run the restart, we create a job that specifies the nodes to run it on and the input parameters. <code>rundeck-project/jobs/RestartApp.yaml</code>:</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> RestartApp
  <span class="token key atrule">uuid</span><span class="token punctuation">:</span> RestartApp
  <span class="token key atrule">nodefilters</span><span class="token punctuation">:</span>
    <span class="token key atrule">filter</span><span class="token punctuation">:</span> web_.*
  <span class="token key atrule">sequence</span><span class="token punctuation">:</span>
    <span class="token key atrule">commands</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">configuration</span><span class="token punctuation">:</span>
          <span class="token key atrule">health_url</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span><span class="token number">8080</span>
          <span class="token key atrule">process</span><span class="token punctuation">:</span> python3
        <span class="token key atrule">nodeStep</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
        <span class="token key atrule">type</span><span class="token punctuation">:</span> RestartApp
    <span class="token key atrule">keepgoing</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
    <span class="token key atrule">strategy</span><span class="token punctuation">:</span> node<span class="token punctuation">-</span>first
</code></pre></div><p>We specify a <code>uuid</code> here so that we know how to refer to it from other jobs, otherwise Rundeck will assign a random uuid.</p> <p>We can test the restart using our <a href="https://github.com/clofresh/rundeck-playground" target="_blank" rel="noopener noreferrer">playground Docker environment<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">make</span> rd-run-job <span class="token assign-left variable"><span class="token environment constant">JOB</span></span><span class="token operator">=</span>RestartApp

<span class="token comment"># Found matching job: RestartApp RestartApp</span>
<span class="token comment"># Execution started: [5] RestartApp /RestartApp &lt;http://127.0.0.1:4440/project/hello-project/execution/show/5&gt;</span>
Restarting python3 app
Waiting <span class="token keyword">for</span> app to stop
Waiting <span class="token keyword">for</span> app to start and <span class="token builtin class-name">return</span> <span class="token number">200</span>
Done
Restarting python3 app
Waiting <span class="token keyword">for</span> app to stop
Waiting <span class="token keyword">for</span> app to start and <span class="token builtin class-name">return</span> <span class="token number">200</span>
Done
</code></pre></div><h3 id="modifying-the-app-config"><a href="#modifying-the-app-config" aria-hidden="true" class="header-anchor">#</a> Modifying the app config</h3> <p>Now we can create a step to update the configured database login on the application nodes. In your production environment you might use a configuration management tool like Ansible or Chef to accomplish this but here we use a simple Python script. We can add this to the <code>providers</code> key of <code>rundeck-plugins/db-creds/plugin.yaml</code>:</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> UpdateDBCredentials
  <span class="token key atrule">service</span><span class="token punctuation">:</span> RemoteScriptNodeStep
  <span class="token key atrule">plugin-type</span><span class="token punctuation">:</span> script
  <span class="token key atrule">script-interpreter</span><span class="token punctuation">:</span> /usr/local/bin/python3
  <span class="token key atrule">script-file</span><span class="token punctuation">:</span> change_password.py
  <span class="token key atrule">script-args</span><span class="token punctuation">:</span> /etc/web.yaml $<span class="token punctuation">{</span>config.user<span class="token punctuation">}</span> $<span class="token punctuation">{</span>config.password<span class="token punctuation">}</span>
  <span class="token key atrule">config</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">type</span><span class="token punctuation">:</span> String
      <span class="token key atrule">name</span><span class="token punctuation">:</span> user
      <span class="token key atrule">title</span><span class="token punctuation">:</span> user
      <span class="token key atrule">description</span><span class="token punctuation">:</span> <span class="token string">&quot;db user&quot;</span>
    <span class="token punctuation">-</span> <span class="token key atrule">type</span><span class="token punctuation">:</span> String
      <span class="token key atrule">name</span><span class="token punctuation">:</span> password
      <span class="token key atrule">title</span><span class="token punctuation">:</span> password
      <span class="token key atrule">description</span><span class="token punctuation">:</span> <span class="token string">&quot;db password&quot;</span>
      <span class="token key atrule">renderingOptions</span><span class="token punctuation">:</span>
        <span class="token key atrule">valueConversion</span><span class="token punctuation">:</span> <span class="token string">&quot;STORAGE_PATH_AUTOMATIC_READ&quot;</span>
</code></pre></div><p>Note the <code>valueConversion: &quot;STORAGE_PATH_AUTOMATIC_READ&quot;</code> setting to able to refer to a path in Key Storage for the database password.</p> <p>Corresponding job config <code>rundeck-project/jobs/UpdateAppConfig.yaml</code>:</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> UpdateAppConfig
  <span class="token key atrule">uuid</span><span class="token punctuation">:</span> UpdateAppConfig
  <span class="token key atrule">nodefilters</span><span class="token punctuation">:</span>
    <span class="token key atrule">filter</span><span class="token punctuation">:</span> web_.*
  <span class="token key atrule">options</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">label</span><span class="token punctuation">:</span> Database user
      <span class="token key atrule">name</span><span class="token punctuation">:</span> dbuser
      <span class="token key atrule">required</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
  <span class="token key atrule">scheduleEnabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
  <span class="token key atrule">sequence</span><span class="token punctuation">:</span>
    <span class="token key atrule">commands</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">nodeStep</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
        <span class="token key atrule">configuration</span><span class="token punctuation">:</span>
          <span class="token key atrule">user</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span>option.dbuser<span class="token punctuation">}</span>
          <span class="token key atrule">password</span><span class="token punctuation">:</span> keys/projects/hello<span class="token punctuation">-</span>project/db/$<span class="token punctuation">{</span>option.dbuser<span class="token punctuation">}</span>
        <span class="token key atrule">type</span><span class="token punctuation">:</span> UpdateDBCredentials
    <span class="token key atrule">keepgoing</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
    <span class="token key atrule">strategy</span><span class="token punctuation">:</span> node<span class="token punctuation">-</span>first
</code></pre></div><p>In the job, we expose an option to the job user to specify the database user to set the config to. We use that value as part of the Key Storage path to look up the password. By using a naming convention for the key path, we hide the details of the Key Storage setup from the job user.</p> <p>We can test it with:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">make</span> rd-run-job <span class="token assign-left variable"><span class="token environment constant">JOB</span></span><span class="token operator">=</span>UpdateAppConfig <span class="token assign-left variable">JOB_OPTIONS</span><span class="token operator">=</span><span class="token string">'-dbuser web2'</span>

<span class="token comment"># Found matching job: UpdateAppConfig UpdateAppConfig</span>
<span class="token comment"># Execution started: [6] UpdateAppConfig /UpdateAppConfig &lt;http://127.0.0.1:4440/project/hello-project/execution/show/6&gt;</span>
Updating /etc/web.yaml with db user credentials: web2
Done
Updating /etc/web.yaml with db user credentials: web2
Done
</code></pre></div><h3 id="creating-the-new-db-login"><a href="#creating-the-new-db-login" aria-hidden="true" class="header-anchor">#</a> Creating the new db login</h3> <p>Creating a new database login requires a super user database login plus a user and password for the new login. Add this to the <code>providers</code> key of <code>rundeck-plugins/db-creds/plugin.yaml</code>:</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> CreateDBUser
  <span class="token key atrule">service</span><span class="token punctuation">:</span> RemoteScriptNodeStep
  <span class="token key atrule">plugin-type</span><span class="token punctuation">:</span> script
  <span class="token key atrule">script-interpreter</span><span class="token punctuation">:</span> /bin/bash
  <span class="token key atrule">script-file</span><span class="token punctuation">:</span> create<span class="token punctuation">-</span>db<span class="token punctuation">-</span>user.sh
  <span class="token key atrule">script-args</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span>config.master_db_user<span class="token punctuation">}</span> $<span class="token punctuation">{</span>config.master_db_password<span class="token punctuation">}</span> $<span class="token punctuation">{</span>config.new_user<span class="token punctuation">}</span> $<span class="token punctuation">{</span>config.new_password<span class="token punctuation">}</span> $<span class="token punctuation">{</span>config.role<span class="token punctuation">}</span>
  <span class="token key atrule">config</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">type</span><span class="token punctuation">:</span> String
      <span class="token key atrule">name</span><span class="token punctuation">:</span> master_db_user
      <span class="token key atrule">title</span><span class="token punctuation">:</span> master_db_user
      <span class="token key atrule">description</span><span class="token punctuation">:</span> <span class="token string">&quot;master db user&quot;</span>
      <span class="token key atrule">default</span><span class="token punctuation">:</span> master1
    <span class="token punctuation">-</span> <span class="token key atrule">type</span><span class="token punctuation">:</span> String
      <span class="token key atrule">name</span><span class="token punctuation">:</span> master_db_password
      <span class="token key atrule">title</span><span class="token punctuation">:</span> master_db_password
      <span class="token key atrule">description</span><span class="token punctuation">:</span> <span class="token string">&quot;master db user password&quot;</span>
      <span class="token key atrule">default</span><span class="token punctuation">:</span> keys/projects/hello<span class="token punctuation">-</span>project/db/master1
      <span class="token key atrule">renderingOptions</span><span class="token punctuation">:</span>
        <span class="token key atrule">valueConversion</span><span class="token punctuation">:</span> <span class="token string">&quot;STORAGE_PATH_AUTOMATIC_READ&quot;</span>
    <span class="token punctuation">-</span> <span class="token key atrule">type</span><span class="token punctuation">:</span> String
      <span class="token key atrule">name</span><span class="token punctuation">:</span> new_user
      <span class="token key atrule">title</span><span class="token punctuation">:</span> new_user
      <span class="token key atrule">description</span><span class="token punctuation">:</span> <span class="token string">&quot;New db user&quot;</span>
    <span class="token punctuation">-</span> <span class="token key atrule">type</span><span class="token punctuation">:</span> String
      <span class="token key atrule">name</span><span class="token punctuation">:</span> new_password
      <span class="token key atrule">title</span><span class="token punctuation">:</span> new_password
      <span class="token key atrule">description</span><span class="token punctuation">:</span> <span class="token string">&quot;New db password&quot;</span>
      <span class="token key atrule">renderingOptions</span><span class="token punctuation">:</span>
        <span class="token key atrule">valueConversion</span><span class="token punctuation">:</span> <span class="token string">&quot;STORAGE_PATH_AUTOMATIC_READ&quot;</span>
    <span class="token punctuation">-</span> <span class="token key atrule">type</span><span class="token punctuation">:</span> String
      <span class="token key atrule">name</span><span class="token punctuation">:</span> role
      <span class="token key atrule">title</span><span class="token punctuation">:</span> role
      <span class="token key atrule">description</span><span class="token punctuation">:</span> <span class="token string">&quot;Database role to grant the new user&quot;</span>
</code></pre></div><p>Corresponding job config <code>rundeck-project/jobs/CreateDbUser.yaml</code>:</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> CreateDbUser
  <span class="token key atrule">uuid</span><span class="token punctuation">:</span> CreateDbUser
  <span class="token key atrule">nodefilters</span><span class="token punctuation">:</span>
    <span class="token key atrule">filter</span><span class="token punctuation">:</span> web_1
  <span class="token key atrule">options</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">label</span><span class="token punctuation">:</span> Master db user version
      <span class="token key atrule">name</span><span class="token punctuation">:</span> master_user_version
      <span class="token key atrule">required</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
      <span class="token key atrule">value</span><span class="token punctuation">:</span> <span class="token string">&quot;1&quot;</span>
    <span class="token punctuation">-</span> <span class="token key atrule">label</span><span class="token punctuation">:</span> Web db user version
      <span class="token key atrule">name</span><span class="token punctuation">:</span> web_user_version
      <span class="token key atrule">required</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
  <span class="token key atrule">sequence</span><span class="token punctuation">:</span>
    <span class="token key atrule">commands</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">nodeStep</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
        <span class="token key atrule">configuration</span><span class="token punctuation">:</span>
          <span class="token key atrule">master_db_user</span><span class="token punctuation">:</span> master$<span class="token punctuation">{</span>option.master_user_version<span class="token punctuation">}</span>
          <span class="token key atrule">master_db_password</span><span class="token punctuation">:</span> keys/projects/hello<span class="token punctuation">-</span>project/db/master$<span class="token punctuation">{</span>option.master_user_version<span class="token punctuation">}</span>
          <span class="token key atrule">new_user</span><span class="token punctuation">:</span> web$<span class="token punctuation">{</span>option.web_user_version<span class="token punctuation">}</span>
          <span class="token key atrule">new_password</span><span class="token punctuation">:</span> keys/projects/hello<span class="token punctuation">-</span>project/db/web$<span class="token punctuation">{</span>option.web_user_version<span class="token punctuation">}</span>
          <span class="token key atrule">role</span><span class="token punctuation">:</span> web
        <span class="token key atrule">type</span><span class="token punctuation">:</span> CreateDBUser
    <span class="token key atrule">keepgoing</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
    <span class="token key atrule">strategy</span><span class="token punctuation">:</span> node<span class="token punctuation">-</span>first
</code></pre></div><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">make</span> rd-run-job <span class="token assign-left variable"><span class="token environment constant">JOB</span></span><span class="token operator">=</span>CreateDbUser <span class="token assign-left variable">JOB_OPTIONS</span><span class="token operator">=</span><span class="token string">'-web_user_version 2'</span>

<span class="token comment"># Found matching job: CreateDbUser CreateDbUser</span>
<span class="token comment"># Execution started: [7] CreateDbUser /CreateDbUser &lt;http://127.0.0.1:4440/project/hello-project/execution/show/7&gt;</span>
GRANT ROLE
</code></pre></div><h3 id="deleting-the-old-db-login"><a href="#deleting-the-old-db-login" aria-hidden="true" class="header-anchor">#</a> Deleting the old db login</h3> <p>Updating <code>rundeck-plugins/db-creds-plugin/plugin.yaml</code>:</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> DeleteDBUser
  <span class="token key atrule">service</span><span class="token punctuation">:</span> RemoteScriptNodeStep
  <span class="token key atrule">plugin-type</span><span class="token punctuation">:</span> script
  <span class="token key atrule">script-interpreter</span><span class="token punctuation">:</span> /bin/bash
  <span class="token key atrule">script-file</span><span class="token punctuation">:</span> delete<span class="token punctuation">-</span>db<span class="token punctuation">-</span>user.sh
  <span class="token key atrule">script-args</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span>config.master_db_user<span class="token punctuation">}</span> $<span class="token punctuation">{</span>config.master_db_password<span class="token punctuation">}</span> $<span class="token punctuation">{</span>config.user<span class="token punctuation">}</span>
  <span class="token key atrule">config</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">type</span><span class="token punctuation">:</span> String
      <span class="token key atrule">name</span><span class="token punctuation">:</span> master_db_user
      <span class="token key atrule">title</span><span class="token punctuation">:</span> master_db_user
      <span class="token key atrule">description</span><span class="token punctuation">:</span> <span class="token string">&quot;master db user&quot;</span>
      <span class="token key atrule">default</span><span class="token punctuation">:</span> master1
    <span class="token punctuation">-</span> <span class="token key atrule">type</span><span class="token punctuation">:</span> String
      <span class="token key atrule">name</span><span class="token punctuation">:</span> master_db_password
      <span class="token key atrule">title</span><span class="token punctuation">:</span> master_db_password
      <span class="token key atrule">description</span><span class="token punctuation">:</span> <span class="token string">&quot;master db user password&quot;</span>
      <span class="token key atrule">default</span><span class="token punctuation">:</span> keys/projects/hello<span class="token punctuation">-</span>project/db/master1
      <span class="token key atrule">renderingOptions</span><span class="token punctuation">:</span>
        <span class="token key atrule">valueConversion</span><span class="token punctuation">:</span> <span class="token string">&quot;STORAGE_PATH_AUTOMATIC_READ&quot;</span>
    <span class="token punctuation">-</span> <span class="token key atrule">type</span><span class="token punctuation">:</span> String
      <span class="token key atrule">name</span><span class="token punctuation">:</span> user
      <span class="token key atrule">title</span><span class="token punctuation">:</span> user
      <span class="token key atrule">description</span><span class="token punctuation">:</span> <span class="token string">&quot;db user to delete&quot;</span>
</code></pre></div><p>And the corresponding job <code>rundeck-project/jobs/DeleteDbUser.yaml</code>:</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> DeleteDbUser
  <span class="token key atrule">uuid</span><span class="token punctuation">:</span> DeleteDbUser
  <span class="token key atrule">nodefilters</span><span class="token punctuation">:</span>
    <span class="token key atrule">filter</span><span class="token punctuation">:</span> web_1
  <span class="token key atrule">options</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">label</span><span class="token punctuation">:</span> Master db user version
      <span class="token key atrule">name</span><span class="token punctuation">:</span> master_user_version
      <span class="token key atrule">required</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
      <span class="token key atrule">value</span><span class="token punctuation">:</span> <span class="token string">&quot;1&quot;</span>
    <span class="token punctuation">-</span> <span class="token key atrule">label</span><span class="token punctuation">:</span> Web db user version
      <span class="token key atrule">name</span><span class="token punctuation">:</span> web_user_version
      <span class="token key atrule">required</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
  <span class="token key atrule">sequence</span><span class="token punctuation">:</span>
    <span class="token key atrule">commands</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">nodeStep</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
        <span class="token key atrule">configuration</span><span class="token punctuation">:</span>
          <span class="token key atrule">master_db_user</span><span class="token punctuation">:</span> master$<span class="token punctuation">{</span>option.master_user_version<span class="token punctuation">}</span>
          <span class="token key atrule">master_db_password</span><span class="token punctuation">:</span> keys/projects/hello<span class="token punctuation">-</span>project/db/master$<span class="token punctuation">{</span>option.master_user_version<span class="token punctuation">}</span>
          <span class="token key atrule">user</span><span class="token punctuation">:</span> web$<span class="token punctuation">{</span>option.web_user_version<span class="token punctuation">}</span>
        <span class="token key atrule">type</span><span class="token punctuation">:</span> DeleteDBUser
</code></pre></div><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">make</span> rd-run-job <span class="token assign-left variable"><span class="token environment constant">JOB</span></span><span class="token operator">=</span>DeleteDbUser <span class="token assign-left variable">JOB_OPTIONS</span><span class="token operator">=</span><span class="token string">'-web_user_version 1'</span>

<span class="token comment"># Found matching job: DeleteDbUser DeleteDbUser</span>
<span class="token comment"># Execution started: [9] DeleteDbUser /DeleteDbUser &lt;http://127.0.0.1:4440/project/hello-project/execution/show/9&gt;</span>
DROP ROLE
</code></pre></div><h3 id="tying-it-all-together"><a href="#tying-it-all-together" aria-hidden="true" class="header-anchor">#</a> Tying it all together</h3> <p>To tie all the steps together into a single job, we can use job reference steps. <code>rundeck-project/jobs/RotateDbCredentials.yaml</code>:</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> RotateDbCredentials
  <span class="token key atrule">uuid</span><span class="token punctuation">:</span> RotateDbCredentials
  <span class="token key atrule">options</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">label</span><span class="token punctuation">:</span> master_user_version
    <span class="token key atrule">name</span><span class="token punctuation">:</span> master_user_version
    <span class="token key atrule">value</span><span class="token punctuation">:</span> <span class="token string">'1'</span>
  <span class="token punctuation">-</span> <span class="token key atrule">label</span><span class="token punctuation">:</span> web_user_version
    <span class="token key atrule">name</span><span class="token punctuation">:</span> web_user_version
    <span class="token key atrule">required</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
  <span class="token punctuation">-</span> <span class="token key atrule">label</span><span class="token punctuation">:</span> prev_web_user_version
    <span class="token key atrule">name</span><span class="token punctuation">:</span> prev_web_user_version
    <span class="token key atrule">required</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
  <span class="token key atrule">sequence</span><span class="token punctuation">:</span>
    <span class="token key atrule">commands</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">jobref</span><span class="token punctuation">:</span>
        <span class="token key atrule">name</span><span class="token punctuation">:</span> CreateDbUser
        <span class="token key atrule">uuid</span><span class="token punctuation">:</span> CreateDbUser
        <span class="token key atrule">nodeStep</span><span class="token punctuation">:</span> <span class="token string">'true'</span>
        <span class="token key atrule">importOptions</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token punctuation">-</span> <span class="token key atrule">jobref</span><span class="token punctuation">:</span>
        <span class="token key atrule">name</span><span class="token punctuation">:</span> UpdateAppConfig
        <span class="token key atrule">uuid</span><span class="token punctuation">:</span> UpdateAppConfig
        <span class="token key atrule">nodeStep</span><span class="token punctuation">:</span> <span class="token string">'true'</span>
        <span class="token key atrule">args</span><span class="token punctuation">:</span> <span class="token punctuation">-</span>dbuser web$<span class="token punctuation">{</span>option.web_user_version<span class="token punctuation">}</span>
    <span class="token punctuation">-</span> <span class="token key atrule">jobref</span><span class="token punctuation">:</span>
        <span class="token key atrule">name</span><span class="token punctuation">:</span> RestartApp
        <span class="token key atrule">name</span><span class="token punctuation">:</span> RestartApp
        <span class="token key atrule">nodeStep</span><span class="token punctuation">:</span> <span class="token string">'true'</span>
    <span class="token punctuation">-</span> <span class="token key atrule">jobref</span><span class="token punctuation">:</span>
        <span class="token key atrule">name</span><span class="token punctuation">:</span> DeleteDbUser
        <span class="token key atrule">uuid</span><span class="token punctuation">:</span> DeleteDbUser
        <span class="token key atrule">nodeStep</span><span class="token punctuation">:</span> <span class="token string">'true'</span>
        <span class="token key atrule">args</span><span class="token punctuation">:</span> <span class="token punctuation">-</span>master_user_version $<span class="token punctuation">{</span>option.master_user_version<span class="token punctuation">}</span> <span class="token punctuation">-</span>web_user_version $<span class="token punctuation">{</span>option.prev_web_user_version<span class="token punctuation">}</span>
    <span class="token key atrule">keepgoing</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
    <span class="token key atrule">strategy</span><span class="token punctuation">:</span> sequential
</code></pre></div><p>We'll need a new user and password, which we can create in the Key Storage:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token builtin class-name">echo</span> <span class="token string">'An0th3r!S3cr3t'</span> <span class="token operator">&gt;</span> rundeck-project/key-storage/keys/projects/hello-project/db/web3
</code></pre></div><p>Then running the job should push the new key. We need to specify both the new version and the previous version that needs deleting.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">make</span> rd-run-job <span class="token assign-left variable"><span class="token environment constant">JOB</span></span><span class="token operator">=</span>RotateDbCredentials <span class="token assign-left variable">JOB_OPTIONS</span><span class="token operator">=</span><span class="token string">'-web_user_version 3 -prev_web_user_version 2'</span>

<span class="token comment"># Created: keys/projects/hello-project/db/web3 [password]</span>
<span class="token comment"># Found matching job: RotateDbCredentials RotateDbCredentials</span>
<span class="token comment"># Execution started: [7] RotateDbCredentials /RotateDbCredentials &lt;http://127.0.0.1:4440/project/hello-project/execution/show/7&gt;</span>
GRANT ROLE
Updating /etc/web.yaml with db user credentials: web3
Done
Updating /etc/web.yaml with db user credentials: web3
Done
Restarting python3 app
Waiting <span class="token keyword">for</span> app to stop
Waiting <span class="token keyword">for</span> app to start and <span class="token builtin class-name">return</span> <span class="token number">200</span>
Done
Restarting python3 app
Waiting <span class="token keyword">for</span> app to stop
Waiting <span class="token keyword">for</span> app to start and <span class="token builtin class-name">return</span> <span class="token number">200</span>
Done
DROP ROLE
</code></pre></div><p>And there you have it: a single command to rotate your database credentials!</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/rundeck/docs-vuepress/edit/master/docs/tutorials/custom-script-plugin-db-cred-rotation.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">7/1/2019, 7:40:35 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/docs-vuepress/tutorials/custom-script-plugin-hello-world.html" class="prev">
          Developing a custom Rundeck script plugin
        </a></span> <span class="next"><a href="/docs-vuepress/tutorials/log-filters.html">
          Using Log Filters
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/docs-vuepress/assets/js/app.a985d805.js" defer></script><script src="/docs-vuepress/assets/js/3.b5c9ac8e.js" defer></script><script src="/docs-vuepress/assets/js/289.216c583c.js" defer></script>
  </body>
</html>
