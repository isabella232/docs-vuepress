(window.webpackJsonp=window.webpackJsonp||[]).push([[117],{504:function(e,r,n){"use strict";n.r(r);var t=n(0),a=Object(t.a)({},function(){var e=this,r=e.$createElement,n=e._self._c||r;return n("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[n("h1",{attrs:{id:"upgrade-rundeck-2-11-x-to-rundeck-3-x"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#upgrade-rundeck-2-11-x-to-rundeck-3-x","aria-hidden":"true"}},[e._v("#")]),e._v(" Upgrade Rundeck 2.11.X to Rundeck 3.X")]),e._v(" "),n("p",[e._v("Updated June 1, 2018")]),e._v(" "),n("h3",{attrs:{id:"rundeck-launcher"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#rundeck-launcher","aria-hidden":"true"}},[e._v("#")]),e._v(" Rundeck Launcher")]),e._v(" "),n("p",[e._v('The "launcher jar" for Rundeck 2 is gone. However, the .war file now operates the same way. Just use the .war in the same way as the previous launcher jar, or deploy it as a webapp.')]),e._v(" "),n("p",[e._v("To upgrade to Rundeck 3 using launcher use the following steps:")]),e._v(" "),n("p",[n("strong",[e._v("NOTE: replace "),n("code",[e._v("$RDECK_BASE")]),e._v(" below with the real path.")])]),e._v(" "),n("ul",[n("li",[n("p",[e._v("Stop Rundeck Service, eg: "),n("code",[e._v("$RDECK_BASE/server/sbin/rundeckd stop")])])]),e._v(" "),n("li",[n("p",[e._v("In case you have customs plugins on "),n("code",[e._v("libext")]),e._v(" folder, backup them. For example, you can move the full "),n("code",[e._v("libext")]),e._v(":")]),e._v(" "),n("pre",[n("code",[e._v("\t```\n\tmv $RDECK_BASE/libext $RDECK_BASE/libext.2-11\n\t```\n")])])]),e._v(" "),n("li",[n("p",[e._v('Remove previous "source" folders:')]),e._v(" "),n("pre",[n("code",[e._v("\t```\n\trm -rf $RDECK_BASE/server/exp/ $RDECK_BASE/server/lib/ $RDECK_BASE/server/sbin/ $RDECK_BASE/tools/\n\t```\n")])])]),e._v(" "),n("li",[n("p",[e._v("Copy the new war file to "),n("code",[e._v("$RDECK_BASE")]),e._v(" and install it:")]),e._v(" "),n("pre",[n("code",[e._v("\t```\n\tjava -jar rundeck-3.X.war --installonly\n\t```\n")])])]),e._v(" "),n("li",[n("p",[e._v("Add the following attribute to "),n("code",[e._v("$RDECK_BASE/server/config/rundeck-config.properties")])]),e._v(" "),n("pre",[n("code",[e._v("\t```\n\trundeck.log4j.config.file=$RDECK_BASE/server/config/log4j.properties\n\t```\n")])])]),e._v(" "),n("li",[n("p",[e._v('Copy the "custom" plugins back to '),n("code",[e._v("$RDECK_BASE/libext")]),e._v(" folder")])]),e._v(" "),n("li",[n("p",[e._v("Start rundeck 3: "),n("code",[e._v("$RDECK_BASE/server/sbin/rundeckd start")])])])]),e._v(" "),n("h3",{attrs:{id:"rundeck-deb-package"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#rundeck-deb-package","aria-hidden":"true"}},[e._v("#")]),e._v(" Rundeck DEB Package")]),e._v(" "),n("p",[e._v("The upgrade process can be done using the "),n("code",[e._v(".deb")]),e._v(" file or using the command "),n("code",[e._v("apt-get")]),e._v(":")]),e._v(" "),n("p",[n("strong",[e._v("If using deb package")])]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("sudo dpkg -i rundeck-3.0.X.deb\n")])])]),n("p",[n("strong",[e._v("If using apt-get")])]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("sudo apt-get upgrade rundeck\n")])])]),n("p",[n("strong",[e._v("Configuration Files:")])]),e._v(" "),n("p",[e._v("When the upgrade command is run, the upgrade process will prompt about what to do with the new version of config files. In the case of "),n("code",[e._v("rundeck-config.properties")]),e._v(", a merge needs to be done between the old and new version, because the attribute "),n("code",[e._v("rundeck.log4j.config.file")]),e._v(" is needed on Rundeck 3 (this attribute is part of the default "),n("code",[e._v("rundeck-config.properties")]),e._v(" template):")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("Configuration file '/etc/rundeck/rundeck-config.properties'\n ==> Modified (by you or by a script) since installation.\n ==> Package distributor has shipped an updated version.\n   What would you like to do about it ?  Your options are:\n    Y or I  : install the package maintainer's version\n    N or O  : keep your currently-installed version\n      D     : show the differences between the versions\n      Z     : start a shell to examine the situation\n The default action is to keep your current version.\n*** rundeck-config.properties (Y/I/N/O/D/Z) [default=N] ?\n")])])]),n("p",[e._v('For example, if you select "YES" the older file will be moved to '),n("code",[e._v("rundeck-config.properties.dpkg-old")]),e._v(", and "),n("code",[e._v("rundeck-config.properties")]),e._v(" will be loaded with the default values (so a merge will be needed)")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("-rw-r----- 1 rundeck rundeck  986 May 11 19:13 realm.properties\n-rw-r----- 1 rundeck rundeck  730 May 11 19:13 project.properties\n-rw-r----- 1 rundeck rundeck 7529 May 11 19:13 log4j.properties\n-rw-r----- 1 rundeck rundeck  136 May 11 19:13 jaas-loginmodule.conf\n-rw-r----- 1 rundeck rundeck 1104 May 11 19:13 apitoken.aclpolicy\n-rw-r----- 1 rundeck rundeck  738 May 11 19:13 admin.aclpolicy\n-rw-r----- 1 rundeck rundeck 1438 Jun  1 19:28 framework.properties\n-rw-r----- 1 rundeck rundeck  454 Jun  1 19:32 rundeck-config.properties\n-rw-r----- 1 rundeck rundeck 3419 Jun  1 19:32 profile\n-rw-r----- 1 rundeck rundeck  511 Jun  1 19:32 cli-log4j.properties\n-rw-r----- 1 rundeck rundeck  673 Jun  4 14:22 rundeck-config.properties.dpkg-old\ndrwxr-x--- 1 rundeck rundeck 4096 Jun  4 14:25 ssl\n")])])]),n("p",[e._v("A restart is necessary after the merge of "),n("code",[e._v("rundeck-config.properties")])]),e._v(" "),n("h3",{attrs:{id:"rundeck-rpm-package"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#rundeck-rpm-package","aria-hidden":"true"}},[e._v("#")]),e._v(" Rundeck RPM Package")]),e._v(" "),n("p",[e._v("The upgrade process can be done using the "),n("code",[e._v(".rpm")]),e._v(" file or using the command "),n("code",[e._v("yum")]),e._v(":")]),e._v(" "),n("h4",{attrs:{id:"using-rpm-package"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#using-rpm-package","aria-hidden":"true"}},[e._v("#")]),e._v(" Using rpm package")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("sh-4.2# rpm -U rundeck-3.x.rpm rundeck-config-3.X.rpm\n\nwarning: /etc/rundeck/framework.properties created as /etc/rundeck/framework.properties.rpmnew\nwarning: /etc/rundeck/rundeck-config.properties created as /etc/rundeck/rundeck-config.properties.rpmnew\nrundeck.server.uuid = XXXXXXXXXXXXXXX\n\n")])])]),n("h4",{attrs:{id:"using-yum"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#using-yum","aria-hidden":"true"}},[e._v("#")]),e._v(" Using yum")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("sh-4.2#  yum upgrade rundeck rundeck-config\n")])])]),n("p",[e._v("In the case of the RPM upgrade, the old properties files are not modified, and the new files are saved with the extension "),n("code",[e._v(".rpmnew")]),e._v(". For the configuration file "),n("code",[e._v("rundeck-config.properties")]),e._v(" a merge is needed to include new default attribute ("),n("code",[e._v("rundeck.log4j.config.file")]),e._v(").")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("sh-4.2# ls -lrt\ntotal 56\n-rw-r----- 1 rundeck rundeck  455 Jun  1 19:34 rundeck-config.properties.rpmnew\n-rw-r----- 1 rundeck rundeck  986 Jun  1 19:34 realm.properties\n-rw-r----- 1 rundeck rundeck  729 Jun  1 19:34 project.properties\n-rw-r----- 1 rundeck rundeck 3426 Jun  1 19:34 profile\n-rw-r----- 1 rundeck rundeck 7538 Jun  1 19:34 log4j.properties\n-rw-r----- 1 rundeck rundeck  136 Jun  1 19:34 jaas-loginmodule.conf\n-rw-r----- 1 rundeck rundeck 1177 Jun  1 19:34 framework.properties.rpmnew\n-rw-r----- 1 rundeck rundeck  511 Jun  1 19:34 cli-log4j.properties\n-rw-r----- 1 rundeck rundeck 1104 Jun  1 19:34 apitoken.aclpolicy\n-rw-r----- 1 rundeck rundeck  738 Jun  1 19:34 admin.aclpolicy\n-rw-r----- 1 rundeck rundeck  673 Jun  4 16:02 rundeck-config.properties\n-rw-r----- 1 rundeck rundeck 1505 Jun  4 16:02 framework.properties\ndrwxr-x--- 1 rundeck rundeck 4096 Jun  4 16:08 ssl\n")])])]),n("p",[e._v("If the "),n("code",[e._v("profile")]),e._v(" file was modified on 2.11.x, the new profile file (for 3.x) will be created with the name "),n("code",[e._v("profile.rpmnew")]),e._v(". If that is the case, merge the changes on the old file and move them to the new one, eg:")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("mv /etc/rundeck/profile.rpmnew /etc/rundeck/profile\n")])])]),n("p",[e._v("A restart is necessary after the merge of "),n("code",[e._v("rundeck-config.properties")]),e._v(" or/and "),n("code",[e._v("profile")]),e._v(" file.")]),e._v(" "),n("h3",{attrs:{id:"tomcat-war-deployment"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#tomcat-war-deployment","aria-hidden":"true"}},[e._v("#")]),e._v(" Tomcat War deployment")]),e._v(" "),n("ul",[n("li",[n("p",[e._v("Stop Tomcat")])]),e._v(" "),n("li",[n("p",[e._v("Delete "),n("code",[e._v("$tomcat.base/webapps/rundeck")])])]),e._v(" "),n("li",[n("p",[e._v("Delete "),n("code",[e._v("$tomcat.base/webapps/rundeck.war")])])]),e._v(" "),n("li",[n("p",[e._v("Place Rundeck 3 as the old war file "),n("code",[e._v("$tomcat.base/webapps/rundeck.war")])])]),e._v(" "),n("li",[n("p",[e._v("Start Tomcat")])])]),e._v(" "),n("h4",{attrs:{id:"notes"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#notes","aria-hidden":"true"}},[e._v("#")]),e._v(" NOTES:")]),e._v(" "),n("ul",[n("li",[n("p",[e._v("Due to changes in authentication, "),n("code",[e._v("tomcat-users.xml")]),e._v(" and other Tomcat's authentication modules no longer work, you should configure users as in a launcher installation.")])]),e._v(" "),n("li",[n("p",[e._v('If you do not have "-Drundeck.config.location" defined or configured in '),n("code",[e._v("$tomcat.base/bin/setenv.sh")]),e._v(" file ("),n("code",[e._v("tomcat.base\\bin\\setenv.bat")]),e._v(" for Windows), it will take "),n("code",[e._v("$rdeck.base/server/config/rundeck-config.properties")]),e._v(".")])]),e._v(" "),n("li",[n("p",[e._v("If Rundeck is not starting, please remove "),n("code",[e._v("$rdeck.base/var/.install_complete")]),e._v(" and restart Tomcat.")])])])])},[],!1,null,null,null);r.default=a.exports}}]);