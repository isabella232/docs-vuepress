(window.webpackJsonp=window.webpackJsonp||[]).push([[49],{499:function(e,t,r){"use strict";r.r(t);var a=r(0),s=Object(a.a)({},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[r("h1",{attrs:{id:"using-microsoft-iis"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#using-microsoft-iis","aria-hidden":"true"}},[e._v("#")]),e._v(" Using Microsoft IIS")]),e._v(" "),r("h2",{attrs:{id:"iis-as-a-loadbalancer"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#iis-as-a-loadbalancer","aria-hidden":"true"}},[e._v("#")]),e._v(" IIS as a loadbalancer")]),e._v(" "),r("p",[e._v("TODO")]),e._v(" "),r("h2",{attrs:{id:"iis-as-a-reverse-proxy"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#iis-as-a-reverse-proxy","aria-hidden":"true"}},[e._v("#")]),e._v(" IIS as a reverse proxy")]),e._v(" "),r("p",[e._v('These steps allow to "integrate" Rundeck with IIS. This could be necessary for example for these user cases:')]),e._v(" "),r("ul",[r("li",[e._v("to get Rundeck through the port 80 in a subdirectory of IIS (e.g. http://yoursite/rundeck)")]),e._v(" "),r("li",[e._v("when It is already set up a SSL certificate for a site and you want to reuse it without fiddling with the java certstore")])]),e._v(" "),r("p",[e._v('If you are at least on 2008R2, you can install the ARR extension to proxy requests to the Jetty instance. To do so, we need first to modify the port rundeck is running and specify the "prefix" for all urls generated by rundeck. Also, to avoid that anyone bypass IIS, rundeck must listen only on 127.0.0.1.')]),e._v(" "),r("p",[e._v("Modify the "),r("code",[e._v("%RDECK_BASE%\\start_rundeck.bat")]),e._v(" port (81) and host (127.0.0.1) as follows:")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v('set CURDIR=%~dp0\ncall %CURDIR%etc\\profile.bat\njava %RDECK_CLI_OPTS% %RDECK_SSL_OPTS%  "-Dserver.http.host=127.0.0.1" "-Dserver.http.port=81" -jar rundeckpro-launcher-XXXX-X.X.X.jar --installonly\n')])])]),r("p",[e._v('But you can also put options in %RDECK_BASE%\\etc\\profile.bat (in this case the "prefix" and the little bit that makes rundeck work behind a reverse proxy) as long as you define all of them.')]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v('set RDECK_CLI_OPTS=-Xmx4096m -Xms1024m "-Drundeck.jetty.connector.forwarded=true" "-Dserver.web.context=/rundeck"\n')])])]),r("p",[e._v("You will need to modify "),r("code",[e._v("%RDECK_BASE%\\server\\config\\rundeck-config.properties")]),e._v(", as "),r("code",[e._v("grails.serverURL")]),e._v(" is needed to be the absolute url:")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("grails.serverURL=http://yoursite/rundeck\n")])])]),r("p",[e._v("Now, in IIS, (at the site level) create an URL Rewrite rule as follows:")]),e._v(" "),r("ul",[r("li",[e._v("add inbound rule")]),e._v(" "),r("li",[e._v('name: route_to_rdeck (or whatever you prefer) matches the pattern (using regular expression): rundeck.* (or a regex matching your "prefix")')]),e._v(" "),r("li",[e._v("action type: rewrite")]),e._v(" "),r("li",[e._v("rewrite url: http://127.0.0.1:81/{R:0}")]),e._v(" "),r("li",[e._v("check append query string")])]),e._v(" "),r("p",[e._v("Then, any request coming to "),r("code",[e._v("http://yoursite/rundeck")]),e._v(" will be proxying to your rundeck instance running on port 81 on the same server, and you'll be sure that every request will come in only proxyied by IIS, since rundeck is only listening to 127.0.0.1.")]),e._v(" "),r("h3",{attrs:{id:"troubleshooting"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#troubleshooting","aria-hidden":"true"}},[e._v("#")]),e._v(" Troubleshooting")]),e._v(" "),r("p",[e._v("If the rewrite module does not work, go to the Application Request Routing settings on the IIS home, and enable the proxy.")])])},[],!1,null,null,null);t.default=s.exports}}]);