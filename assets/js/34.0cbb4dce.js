(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{193:function(e,o,r){"use strict";r.r(o);var t=r(0),i=Object(t.a)({},function(){var e=this,o=e.$createElement,r=e._self._c||o;return r("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[r("h1",{attrs:{id:"configuring"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#configuring","aria-hidden":"true"}},[e._v("#")]),e._v(" Configuring")]),e._v(" "),r("h2",{attrs:{id:"configuring-plugins-for-use"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#configuring-plugins-for-use","aria-hidden":"true"}},[e._v("#")]),e._v(" Configuring Plugins for Use")]),e._v(" "),r("h3",{attrs:{id:"workflow-steps"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#workflow-steps","aria-hidden":"true"}},[e._v("#")]),e._v(" Workflow Steps")]),e._v(" "),r("p",[e._v("Workflow Step and Workflow Node Step providers are used to define custom steps that\ncan be performed in Workflows.")]),e._v(" "),r("p",[e._v("You can select a step plugin in the GUI when adding a new step to a Workflow. You\nwill be prompted to enter any configuration properties for the step, and can save those\nconfiguration values into your workflow.")]),e._v(" "),r("p",[e._v("If you are defining a workflow in an XML/Yaml-formatted file, you can\nspecify the configuration properties there.")]),e._v(" "),r("p",[e._v('Each configuration property has a "scope" defined by the provider. Scoped properties\nallow default values to be specified at Framework (application) or Project level\nconfiguration properties. Properties can also be defined to only\nexist at Framework or Project levels.')]),e._v(" "),r("ol",[r("li",[e._v("Instance (Job) scope: the property values defined in the Job definition")]),e._v(" "),r("li",[e._v("Project scope: property values defined in the Project's "),r("em",[e._v("project.properties")]),e._v(" file")]),e._v(" "),r("li",[e._v("Framework (Application) scope: property values defined in Rundeck's "),r("em",[e._v("framework.properties")]),e._v(" file.")])]),e._v(" "),r("p",[e._v("When determining the property value to use, Rundeck will evaluate the most-specific scope first (Instance level), and\nthen widen the scope to Project, then Framework definitions.")]),e._v(" "),r("p",[e._v("When you create a Job in the Rundeck GUI, you will be shown the Instance-scope properties\nas part of the GUI Workflow Builder for any plugin step that you add to your workflow.")]),e._v(" "),r("p",[e._v("When a property can be configured at the framework/project level, you will be able to define it like this:")]),e._v(" "),r("p",[r("em",[e._v("Framework scope property definition in "),r("code",[e._v("framework.properties")])])]),e._v(" "),r("pre",[r("code",[e._v("framework.plugin.[ServiceName].[providerName].[property]=value\n")])]),e._v(" "),r("p",[r("em",[e._v("Project scope property definition in "),r("code",[e._v("project.properties")])])]),e._v(" "),r("pre",[r("code",[e._v("project.plugin.[ServiceName].[providerName].[property]=value\n")])]),e._v(" "),r("h3",{attrs:{id:"node-execution"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#node-execution","aria-hidden":"true"}},[e._v("#")]),e._v(" Node Execution")]),e._v(" "),r("p",[e._v("The two "),r("em",[e._v("Node services")]),e._v(", Node Executor and File Copier, are both configured similarly.\nThey are configured for particular nodes on a node-specific basis,\nor set as a default provider for a project or for the system.")]),e._v(" "),r("p",[e._v("If multiple providers are defined the most specific definition takes precedence\nin this order:")]),e._v(" "),r("ol",[r("li",[e._v("Node specific")]),e._v(" "),r("li",[e._v("Project scope")]),e._v(" "),r("li",[e._v("Framework scope")])]),e._v(" "),r("h4",{attrs:{id:"node-specific"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#node-specific","aria-hidden":"true"}},[e._v("#")]),e._v(" Node Specific")]),e._v(" "),r("p",[e._v("To enable a provider for a node, add an attribute to the node definition.")]),e._v(" "),r("p",[r("em",[e._v("Node Executor provider attributes")]),e._v(":")]),e._v(" "),r("p",[r("code",[e._v("node-executor")])]),e._v(" "),r("p",[e._v(": specifies the provider name for a non-local node.")]),e._v(" "),r("p",[r("code",[e._v("local-node-executor")])]),e._v(" "),r("p",[e._v(": specifies the provider name for the local (server) node.")]),e._v(" "),r("p",[r("em",[e._v("FileCopier provider attributes")]),e._v(":")]),e._v(" "),r("p",[r("code",[e._v("file-copier")])]),e._v(" "),r("p",[e._v(": specifies the provider by name for a non-local node.")]),e._v(" "),r("p",[r("code",[e._v("local-file-copier")])]),e._v(" "),r("p",[e._v(": specifies the provider by name for the local (server) node.")]),e._v(" "),r("p",[e._v("Example Node in YAML specifying "),r("code",[e._v("stub")]),e._v(" NodeExecutor and FileCopier:")]),e._v(" "),r("div",{staticClass:"language-{.yaml} extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("remotehost:\n    hostname: remotehost\n    node-executor: stub\n    file-copier: stub\n")])])]),r("h4",{attrs:{id:"project-or-framework-scope"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#project-or-framework-scope","aria-hidden":"true"}},[e._v("#")]),e._v(" Project or Framework Scope")]),e._v(" "),r("p",[r("em",[e._v("Node Executor")])]),e._v(" "),r("p",[e._v("You can define the default connection providers to use for nodes at either the Project or\nFramework scope (or both). To do so, configure any of the following properties\nin the "),r("code",[e._v("project.properties")]),e._v(" or the "),r("code",[e._v("framework.properties")]),e._v(" files.")]),e._v(" "),r("p",[r("code",[e._v("service.NodeExecutor.default.provider")])]),e._v(" "),r("p",[e._v(": Specifies the default NodeExecutor provider for remote nodes")]),e._v(" "),r("p",[r("code",[e._v("service.NodeExecutor.default.local.provider")])]),e._v(" "),r("p",[e._v(": Specifies the default Node Executor provider for the local node.")]),e._v(" "),r("p",[r("em",[e._v("File Copier")])]),e._v(" "),r("p",[r("code",[e._v("service.FileCopier.default.provider")])]),e._v(" "),r("p",[e._v(": Specifies the default File Copier provider for remote nodes.")]),e._v(" "),r("p",[r("code",[e._v("service.FileCopier.default.local.provider")])]),e._v(" "),r("p",[e._v(": Specifies the default File Copier provider for the local node.")]),e._v(" "),r("p",[e._v("Example "),r("code",[e._v("project.properties")]),e._v(" to set default local providers to "),r("code",[e._v("stub")]),e._v(":")]),e._v(" "),r("pre",[r("code",[e._v("service.NodeExecutor.default.local.provider=stub\nservice.FileCopier.default.local.provider=stub\n")])]),e._v(" "),r("h3",{attrs:{id:"resource-model-sources"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#resource-model-sources","aria-hidden":"true"}},[e._v("#")]),e._v(" Resource Model Sources")]),e._v(" "),r("p",[e._v("The "),r("em",[e._v("Resource Model Sources")]),e._v(" providers can be configured for a single project\nin the "),r("code",[e._v("project.properties")]),e._v(" file.")]),e._v(" "),r("p",[e._v("You can define multiple Resource Model Sources for the project, and can mix and match\nthe specific providers depending on your needs.")]),e._v(" "),r("p",[e._v("When you define multiple Source providers in a project, then the resulting set of Nodes will\neffectively be a merge of all the sources, in the order in which they are declared. This\nmeans that if two or more Sources provide a definition of a node with the same name, then\nthe definition from lowest Source in the list will be used.")]),e._v(" "),r("p",[e._v("The order that the providers are loaded (and thus the nodes are merged) is:")]),e._v(" "),r("ol",[r("li",[r("code",[e._v("project.resources.file")]),e._v(": A File Model Source with default configuration.")]),e._v(" "),r("li",[r("code",[e._v("project.resources.url")]),e._v(": A URL Model Source with default configuration. (optional)")]),e._v(" "),r("li",[e._v("All "),r("code",[e._v("resources.source.N")]),e._v(" configurations in order starting at 1")])]),e._v(" "),r("h4",{attrs:{id:"resource-model-source-configuration"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#resource-model-source-configuration","aria-hidden":"true"}},[e._v("#")]),e._v(" Resource Model Source configuration")]),e._v(" "),r("p",[e._v("The "),r("code",[e._v("project.properties")]),e._v(" file for each project allows you to configure the Resource Model Sources in these ways:")]),e._v(" "),r("ul",[r("li",[e._v("Define "),r("code",[e._v("project.resources.file")]),e._v(" - this file path is used as a File Source path, with "),r("em",[e._v("autogeneration")]),e._v(" and "),r("em",[e._v("includeServerNode")]),e._v(" both true.")]),e._v(" "),r("li",[e._v("Define "),r("code",[e._v("project.resources.url")]),e._v(" - this URL is used as a URL Source url, with caching enabled")])]),e._v(" "),r("p",[e._v("You may also define a list of more sources in this way:")]),e._v(" "),r("p",[e._v("Starting at index "),r("code",[e._v("1")]),e._v(", define these properties for your Source numbered "),r("code",[e._v("N")]),e._v(":")]),e._v(" "),r("pre",[r("code",[e._v("resources.source.N.type=<provider-name>\nresources.source.N.config.<property>=<value>\nresources.source.N.config.<property2>=<value2>\n...\n")])]),e._v(" "),r("p",[e._v("Using one of the available Resource Model Source provider names for the "),r("code",[e._v("<provider-name>")]),e._v(" value. For each Resource Model Source provider,\nyou can specify the configuration properties for the source.")]),e._v(" "),r("p",[e._v("Example project.properties configuration of a default File provider, and two other providers:")]),e._v(" "),r("pre",[r("code",[e._v("project.resources.file=/home/rundeck/projects/example/etc/resources.xml\n\nresources.source.1.type=url\nresources.source.1.url=http://server/nodes.yaml\n\nresources.source.2.type=directory\nresources.source.2.directory=/home/rundeck/projects/example/resources\n")])]),e._v(" "),r("h3",{attrs:{id:"resource-format-generators-and-parsers"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#resource-format-generators-and-parsers","aria-hidden":"true"}},[e._v("#")]),e._v(" Resource Format Generators and Parsers")]),e._v(" "),r("p",[e._v("Resource Format Generators and Parsers define support for file formats that can\nbe generated from or parsed into a set of Resource Node definitions.")]),e._v(" "),r("p",[e._v("These are used by other parts of the system, such as the Resource Model Sources.")]),e._v(" "),r("p",[e._v('There is no configuration necessary to use these providers, however the specific\nProvider Name that each generator and parser defines has to be known in order\nto make use of the provider. The specific Provider Name is used as the\n"format name" when you want to use the parser or generator.')]),e._v(" "),r("p",[e._v("For example, to enable a particular Resource Format parser to be used by a File\nResource Model Source (see "),r("router-link",{attrs:{to:"/administration/projects/resource-model-sources/#file-resource-model-source-configuration]"}},[e._v("File Resource Model Source Configuration")]),e._v(", you should specify\nthe Provider Name for the parser as the format for the source:")],1),e._v(" "),r("pre",[r("code",[e._v("resources.source.1.format=myformat\n")])]),e._v(" "),r("p",[e._v('This would specify the use of "myformat" provider.')]),e._v(" "),r("p",[e._v("In other cases, the exact name of the provider may not be known (for example\nwhen loading content from a remote URL). Each Generator and Parser must define\na list of MIME Type strings and file extensions that they support. These\nare used to determine which parser/generator is to be used.")]),e._v(" "),r("h3",{attrs:{id:"notifications"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#notifications","aria-hidden":"true"}},[e._v("#")]),e._v(" Notifications")]),e._v(" "),r("p",[e._v('Notifications can be configured for Jobs, and can be triggered when certain\nconditions occur. These conditions are called "triggers", these are the\ncurrently available triggers:')]),e._v(" "),r("ul",[r("li",[r("code",[e._v("onstart")]),e._v(" - the Job started")]),e._v(" "),r("li",[r("code",[e._v("onsuccess")]),e._v(" - the Job succeeded")]),e._v(" "),r("li",[r("code",[e._v("onfailure")]),e._v(" - the Job failed")]),e._v(" "),r("li",[r("code",[e._v("onavgduration")]),e._v(" - the Execution exceed the average duration of the Job")]),e._v(" "),r("li",[r("code",[e._v("onretryablefailure")]),e._v(" - the Job failed but will be retried")])]),e._v(" "),r("p",[e._v("When you define the Job in the GUI or via [XML](/manpages/man5/job-v20.md#notification] or\n[Yaml](/manpages/man5/job-yaml-v12.md#notification], you can add any of the available Notification plugin types to happen for\nany of the possible triggers. Each Notification plugin type may have unique\nconfiguration properties that you can specify. Each combination of trigger and\nNotification type has a unique configuration.")]),e._v(" "),r("p",[e._v('When defining configuration values for a plugin, you can usually substitute\nany "Job context variables" that are listed under (/manual/job-workflows.md#context-variables]]. (Note: Some configuration properties of a plugin may not support this feature.)')]),e._v(" "),r("p",[e._v("In addition, you can also use these variables:")]),e._v(" "),r("ul",[r("li",[r("code",[e._v("${job.user.name}")]),e._v(" - the user who executed the job")]),e._v(" "),r("li",[r("code",[e._v("${job.user.email}")]),e._v(" - the email of the executing user if set in their user profile")]),e._v(" "),r("li",[r("code",[e._v("${job.user.firstName}")]),e._v(" - the first name of the executing user if set in their user profile")]),e._v(" "),r("li",[r("code",[e._v("${job.user.lastName}")]),e._v(" - the first name of the executing user if set in their user profile")])]),e._v(" "),r("h3",{attrs:{id:"logging"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#logging","aria-hidden":"true"}},[e._v("#")]),e._v(" Logging")]),e._v(" "),r("p",[e._v("Logging plugins consist of Readers and Writers, and Log File Storage.\nRundeck has a built-in Reader/Writer called the "),r("strong",[e._v("Local File Log")]),e._v(" that is used by default.")]),e._v(" "),r("p",[e._v("Logging plugins are enabled in the "),r("code",[e._v("rundeck-config")]),e._v(' file. You should add an entry identifying the plugin by its "provider name". For Java plugins, this provider name is defined in the Java code. For Groovy plugins, the provider name is usually just the name of the Groovy script file, such as "MyStreamingLogWriterPlugin".')]),e._v(" "),r("p",[e._v("To add StreamingLogWriter plugins, add a comma separated list to this entry, note that this will enable these plugins in addition to the "),r("strong",[e._v("Local File Log Writer")]),e._v(":")]),e._v(" "),r("ul",[r("li",[r("code",[e._v("rundeck.execution.logs.streamingWriterPlugins")]),e._v(" "),r("ul",[r("li",[e._v("example value: "),r("code",[e._v("MyStreamingLogWriterPlugin,otherPlugin")])])])])]),e._v(" "),r("p",[e._v("To change the StreamingLogReader plugin. Note that this will replace the "),r("strong",[e._v("Local File Log Reader")]),e._v(", but will not disable the "),r("strong",[e._v("Local File Log Writer")]),e._v(":")]),e._v(" "),r("ul",[r("li",[r("code",[e._v("rundeck.execution.logs.streamingReaderPlugin")]),e._v(" "),r("ul",[r("li",[e._v("example value: "),r("code",[e._v("MyStreamingLogReaderPlugin")])])])])]),e._v(" "),r("p",[e._v("To disable the "),r("strong",[e._v("Local File Log Writer")]),e._v(":")]),e._v(" "),r("ul",[r("li",[r("code",[e._v("rundeck.execution.logs.localFileStorageEnabled")]),e._v(" "),r("ul",[r("li",[e._v("value: "),r("code",[e._v("false")])])])])]),e._v(" "),r("p",[e._v("To configure a ExecutionFileStorage plugin:")]),e._v(" "),r("ul",[r("li",[r("code",[e._v("rundeck.execution.logs.fileStoragePlugin")]),e._v(" "),r("ul",[r("li",[e._v("example value: "),r("code",[e._v("MyFileStoragePlugin")])])])])]),e._v(" "),r("p",[e._v("Also, if "),r("code",[e._v("localFileStorageEnabled")]),e._v(" is "),r("code",[e._v("false")]),e._v(", but no "),r("code",[e._v("streamingReaderPlugin")]),e._v(" is enabled, then Rundeck will still default to using the "),r("strong",[e._v("Local File Log Writer")]),e._v(".")]),e._v(" "),r("p",[e._v("The ExecutionFileStorage plugins also have some associated configuration values\nthat can be used to tune the behavior of the plugins:")]),e._v(" "),r("ul",[r("li",[r("code",[e._v("rundeck.execution.logs.fileStorage.storageRetryCount")]),e._v(" "),r("ul",[r("li",[e._v("The number of "),r("code",[e._v("store")]),e._v(" attempts to try before giving up for a single log file")]),e._v(" "),r("li",[e._v("default value: "),r("code",[e._v("1")])])])]),e._v(" "),r("li",[r("code",[e._v("rundeck.execution.logs.fileStorage.storageRetryDelay")]),e._v(" "),r("ul",[r("li",[e._v("Time to wait between retry attempts")]),e._v(" "),r("li",[e._v("default value: "),r("code",[e._v("60")]),e._v(" (seconds)")])])]),e._v(" "),r("li",[r("code",[e._v("rundeck.execution.logs.fileStorage.retrievalRetryCount")]),e._v(" "),r("ul",[r("li",[e._v("The number of "),r("code",[e._v("retrieve")]),e._v(" attempts to try before giving up for a single log file")]),e._v(" "),r("li",[e._v("default value: "),r("code",[e._v("3")])])])]),e._v(" "),r("li",[r("code",[e._v("rundeck.execution.logs.fileStorage.retrievalRetryDelay")]),e._v(" "),r("ul",[r("li",[e._v("Time to wait between retry attempts")]),e._v(" "),r("li",[e._v("default value: "),r("code",[e._v("60")]),e._v(" (seconds)")])])]),e._v(" "),r("li",[r("code",[e._v("rundeck.execution.logs.fileStorage.remotePendingDelay")]),e._v(" "),r("ul",[r("li",[e._v('Grace time to allow after an execution finishes. Clients will see a "pending" message within this period after an execution finishes, even if the storage plugin is unable to find the log file. After this time period, they will see a "not found" message if the plugin is unable to find the log file.')]),e._v(" "),r("li",[e._v("default value: "),r("code",[e._v("120")]),e._v(" (seconds)")])])]),e._v(" "),r("li",[r("code",[e._v("rundeck.execution.logs.fileStorage.retrievalTasks.concurrencyLimit")]),e._v(" "),r("ul",[r("li",[e._v("concurrency for retrieval tasks")]),e._v(" "),r("li",[e._v("default: 5")])])]),e._v(" "),r("li",[r("code",[e._v("rundeck.execution.logs.fileStorage.storageTasks.concurrencyLimit")]),e._v(" "),r("ul",[r("li",[e._v("concurrency for storage tasks")]),e._v(" "),r("li",[e._v("default: 10")])])]),e._v(" "),r("li",[r("code",[e._v("rundeck.execution.logs.fileStorage.scheduledTasks.poolSize")]),e._v(" "),r("ul",[r("li",[e._v("threadpool size for log storage retry scheduling (retries)")]),e._v(" "),r("li",[e._v("default: 5")])])])]),e._v(" "),r("p",[e._v("For plugins that support Partial/Checkpoint log storage, these additional configuration properties can be set:")]),e._v(" "),r("ul",[r("li",[r("code",[e._v("rundeck.execution.logs.fileStorage.checkpoint.time.interval")]),e._v(" default: "),r("code",[e._v("30s")]),e._v(" (30 seconds)\n"),r("ul",[r("li",[e._v("This is the time interval between submitting a new partial log storage request")])])]),e._v(" "),r("li",[r("code",[e._v("rundeck.execution.logs.fileStorage.checkpoint.time.minimum")]),e._v(" default: "),r("code",[e._v("30s")]),e._v(" (30 seconds)\n"),r("ul",[r("li",[e._v("This is the minimum time to wait until the first partial log storage request")])])]),e._v(" "),r("li",[r("code",[e._v("rundeck.execution.logs.fileStorage.checkpoint.fileSize.minimum")]),e._v(" default: "),r("code",[e._v("0")]),e._v(" (no minimum)\n"),r("ul",[r("li",[e._v("This is the minimum file size before the first partial log storage request")])])]),e._v(" "),r("li",[r("code",[e._v("rundeck.execution.logs.fileStorage.checkpoint.fileSize.increment")]),e._v(" default: "),r("code",[e._v("0")]),e._v(" (no minimum increment)\n"),r("ul",[r("li",[e._v("this is the file size change increment required before submitting another partial log storage request")])])])]),e._v(" "),r("h4",{attrs:{id:"logging-plugin-configuration"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#logging-plugin-configuration","aria-hidden":"true"}},[e._v("#")]),e._v(" Logging Plugin Configuration")]),e._v(" "),r("p",[e._v("Logging plugins can define configuration properties, which can be set in the "),r("code",[e._v("framework.properties")]),e._v(" (system-wide) or "),r("code",[e._v("project.properties")]),e._v(" (project-wide). Project-level properties override system-level properties.")]),e._v(" "),r("p",[e._v("To add a configuration property, add a value to the appropriate file in the following format:")]),e._v(" "),r("p",[r("code",[e._v("SCOPE.plugin.TYPE.PROVIDER.PROPERTY=value")])]),e._v(" "),r("p",[r("code",[e._v("SCOPE")]),e._v(" is either "),r("code",[e._v("framework")]),e._v(" or "),r("code",[e._v("project")]),e._v(".")]),e._v(" "),r("p",[e._v("The "),r("code",[e._v("TYPE")]),e._v(" is one of:")]),e._v(" "),r("ul",[r("li",[r("code",[e._v("StreamingLogReader")]),e._v(", "),r("code",[e._v("StreamingLogWriter")]),e._v(", or "),r("code",[e._v("ExecutionFileStorage")])])]),e._v(" "),r("p",[r("code",[e._v("PROVIDER")]),e._v(" is the provider name of the plugin.")]),e._v(" "),r("h3",{attrs:{id:"storage-plugins"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#storage-plugins","aria-hidden":"true"}},[e._v("#")]),e._v(" Storage Plugins")]),e._v(" "),r("p",[e._v("Storage plugins for the "),r("router-link",{attrs:{to:"/administration/configuration/storage-facility.html"}},[e._v("Storage Facility")]),e._v("\nare configured in the "),r("code",[e._v("rundeck-config.properties")]),e._v(" file.")],1),e._v(" "),r("p",[e._v('Two separate "containers" are used, one for Key Storage, and one for Project Definition Storage.')]),e._v(" "),r("ul",[r("li",[e._v("Key Storage\n"),r("ul",[r("li",[e._v("uses a configuration prefix of "),r("code",[e._v("rundeck.storage.provider")])]),e._v(" "),r("li",[e._v("uses "),r("code",[e._v("file")]),e._v(" provider by default, stored at the "),r("code",[e._v("${framework.var.dir}/storage")]),e._v(" path")]),e._v(" "),r("li",[e._v("stores all content under the "),r("code",[e._v("/keys")]),e._v(" top-level path")])])]),e._v(" "),r("li",[e._v("Project Definition Storage\n"),r("ul",[r("li",[e._v("uses a configuration prefix of "),r("code",[e._v("rundeck.config.storage.provider")])]),e._v(" "),r("li",[e._v("uses "),r("code",[e._v("db")]),e._v(" provider by default")]),e._v(" "),r("li",[e._v("stores all content under the "),r("code",[e._v("/projects")]),e._v(" top-level path")])])])]),e._v(" "),r("p",[e._v("To configure a different Storage Plugin Provider for either "),r("strong",[e._v("Key Storage")]),e._v(" or "),r("strong",[e._v("Project Definition Storage")]),e._v(",\nmodify your "),r("code",[e._v("rundeck-config.properties")]),e._v(" file:")]),e._v(" "),r("p",[e._v("To use the "),r("code",[e._v("db")]),e._v(" storage:")]),e._v(" "),r("pre",[r("code",[e._v("[prefix].1.type=db\n[prefix].1.path=/\n")])]),e._v(" "),r("p",[e._v("To use the "),r("code",[e._v("file")]),e._v(" storage:")]),e._v(" "),r("pre",[r("code",[e._v("[prefix].1.type=file\n[prefix].1.path=/\n[prefix].1.config.baseDir=${framework.var.dir}/storage\n")])]),e._v(" "),r("p",[e._v("Each Storage Plugin defines its own configuration properties, so if you are using a third-party plugin refer to its documentation. You can set the configuration properties via "),r("code",[e._v("[prefix].#.config.PROPERTY")]),e._v(".")]),e._v(" "),r("p",[e._v("Settings of the Storage Plugin:")]),e._v(" "),r("ul",[r("li",[r("code",[e._v("type")]),e._v(" - plugin provider name to use")]),e._v(" "),r("li",[r("code",[e._v("path")]),e._v(" - path within the storage tree to apply the storage plugin. If "),r("code",[e._v("/")]),e._v(" this would be the root, and apply to all subdirectories. You can add additional providers within a subdirectory such as "),r("code",[e._v("/subdir")]),e._v(", and that plugin would only apply to things within that subdirectory.")]),e._v(" "),r("li",[r("code",[e._v("removePathPrefix")]),e._v(" - true/false (default: false). By default, the storage plugin will be invoked using the full path that is requested, and if you used "),r("code",[e._v("path")]),e._v(" to locate the provider at a subdirectory, the requested path includes the subdirectory name (the prefix). If set to "),r("code",[e._v("true")]),e._v(", the path used when invoking the storage plugin would not include that prefix.")]),e._v(" "),r("li",[r("code",[e._v("config.*")]),e._v(" - specific configuration properties of the Storage Plugin")])]),e._v(" "),r("p",[e._v("For the builtin "),r("code",[e._v("file")]),e._v(" implementation, these are the configuration properties:")]),e._v(" "),r("ul",[r("li",[r("code",[e._v("baseDir")]),e._v(" - Local filepath to store files and metadata. Default is "),r("code",[e._v("${framework.var.dir}/storage")])])]),e._v(" "),r("p",[e._v("The "),r("code",[e._v("db")]),e._v(" implementation has no configuration properties.")]),e._v(" "),r("h4",{attrs:{id:"using-multiple-storage-plugins"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#using-multiple-storage-plugins","aria-hidden":"true"}},[e._v("#")]),e._v(" Using Multiple Storage Plugins")]),e._v(" "),r("p",[e._v("You can combine multiple Storage Plugins to operate over different branches of the Storage Tree, by defining multiple configurations and using the "),r("code",[e._v("path")]),e._v(" to locate them within the tree. You could use this, for example, to store some Keys in the database, some on the local filesystem, and some in some other backend provider, such as Vault.")]),e._v(" "),r("p",[e._v("You would defin multiple configurations using sequential index numbers, and apply them to specific "),r("code",[e._v("path")]),e._v(" locations.")]),e._v(" "),r("p",[e._v("Example:")]),e._v(" "),r("pre",[r("code",[e._v("rundeck.storage.provider.1.type=db\nrundeck.storage.provider.1.path=/keys\n\nrundeck.storage.provider.2.type=file\nrundeck.storage.provider.2.path=/keys/local\nrundeck.storage.provider.2.config.baseDir=/var/local/rundeck\n\nrundeck.storage.provider.3.type=vault-plugin\nrundeck.storage.provider.3.path=/keys/vault\nrundeck.storage.provider.3.removePathPrefix=true\n")])]),e._v(" "),r("p",[e._v("In this configuration, anything stored under "),r("code",[e._v("keys/vault")]),e._v(" would be stored with the Vault plugin,\nand the "),r("code",[e._v("removePathPrefix")]),e._v(" means that the Vault plugin would not see the "),r("code",[e._v("keys/vault")]),e._v(" prefix in the path it uses internally.\nAnything stored under "),r("code",[e._v("keys/local")]),e._v(" would be stored on the filesystem under "),r("code",[e._v("/var/local/rundeck")]),e._v("\nusing the full path (including "),r("code",[e._v("keys/local")]),e._v(").\nAnything else, e.g. under "),r("code",[e._v("keys/anotherdir")]),e._v(" or just under "),r("code",[e._v("keys")]),e._v(" would be stored in the DB.")]),e._v(" "),r("p",[e._v("If you define multiple configurations that use the same path, the later configuration would override the previous one.\nIf you define a configuration that uses a subpath of a previous configuration, the most specific path will apply, such\nas in the "),r("code",[e._v("keys")]),e._v(" stored in DB and "),r("code",[e._v("keys/vault")]),e._v(" using Vault examples above.")]),e._v(" "),r("h3",{attrs:{id:"storage-converter-plugins"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#storage-converter-plugins","aria-hidden":"true"}},[e._v("#")]),e._v(" Storage Converter Plugins")]),e._v(" "),r("p",[e._v("Storage Converter plugins are configured in the "),r("code",[e._v("rundeck-config.properties")]),e._v(" file.")]),e._v(" "),r("p",[e._v('Two separate "containers" are used, one for Key Storage, and one for Project Definition Storage.')]),e._v(" "),r("ul",[r("li",[e._v("Key Storage\n"),r("ul",[r("li",[e._v("uses a configuration prefix of "),r("code",[e._v("rundeck.storage.converter")])])])]),e._v(" "),r("li",[e._v("Project Definition Storage\n"),r("ul",[r("li",[e._v("uses a configuration prefix of "),r("code",[e._v("rundeck.config.storage.converter")])])])])]),e._v(" "),r("p",[e._v("Add an entry in your "),r("code",[e._v("rundeck-config.properties")]),e._v(" file declaring the converter plugin\nwhich will handle content in subpath of the storage container.")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("[prefix].1.type=my-encryption-plugin\n[prefix].1.path=/keys\n[prefix].1.config.foo=my config value\n")])])]),r("ul",[r("li",[r("code",[e._v("type")]),e._v(" - specifies the plugin provider name")]),e._v(" "),r("li",[r("code",[e._v("path")]),e._v(" - specifies the storage path the converter will apply to")]),e._v(" "),r("li",[r("code",[e._v("resourceSelector")]),e._v(" - specifies a metadata selector to choose which resources to apply the converter to")]),e._v(" "),r("li",[r("code",[e._v("config.PROP")]),e._v(" - specifies a plugin configuration property")])]),e._v(" "),r("p",[e._v("The "),r("code",[e._v("resourceSelector")]),e._v(" allows applying the converter to only resources which have the matching metadata. The format for the value is:")]),e._v(" "),r("pre",[r("code",[e._v("key OP value [; key OP value]*\n")])]),e._v(" "),r("p",[e._v("Available metadata keys:")]),e._v(" "),r("ul",[r("li",[r("code",[e._v("Rundeck-content-type")]),e._v(": the Content type of the stored file")]),e._v(" "),r("li",[r("code",[e._v("Rundeck-key-type")]),e._v(": a value of "),r("code",[e._v("public")]),e._v(" or "),r("code",[e._v("private")]),e._v(" for Keys.")])]),e._v(" "),r("p",[r("code",[e._v("OP")]),e._v(" can be "),r("code",[e._v("=")]),e._v(" for exact match, or "),r("code",[e._v("=~")]),e._v(" for regular expression match.")]),e._v(" "),r("p",[e._v("For example, this will apply only to private key files:")]),e._v(" "),r("pre",[r("code",[e._v("rundeck.storage.converter.1.resourceSelector = Rundeck-key-type=private\n")])]),e._v(" "),r("p",[e._v("If a value for "),r("code",[e._v("resourceSelector")]),e._v(" is not specified, the converter plugin will apply to all files in the matching path.")]),e._v(" "),r("h4",{attrs:{id:"using-multiple-storage-converter-plugins"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#using-multiple-storage-converter-plugins","aria-hidden":"true"}},[e._v("#")]),e._v(" Using Multiple Storage Converter Plugins")]),e._v(" "),r("p",[e._v("Similar to using multiple Storage Plugins, you can define multiple converters using sequential indexes\nand applying them to paths within the root. You can use the same or different converters with different configurations\non different parts of the tree.")]),e._v(" "),r("p",[e._v("Note that multiple Storage Converter Plugin configurations can be defined that apply to the same paths. In that case\nall matching Storage Converter Plugins will be applied to the paths during reading and writing of storage contents,\nin the order that they are declared.")])])},[],!1,null,null,null);o.default=i.exports}}]);